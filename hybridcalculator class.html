

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>HybridCalculator class &mdash; Pysic 0.6 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Pysic 0.6 documentation" href="index.html" />
    <link rel="up" title="Pysic module" href="pysic.html" />
    <link rel="next" title="Subsystem class" href="subsystem class.html" />
    <link rel="prev" title="ChargeRelaxation class" href="chargerelaxation class.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="subsystem class.html" title="Subsystem class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chargerelaxation class.html" title="ChargeRelaxation class"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pysic 0.6 documentation</a> &raquo;</li>
          <li><a href="pysic.html" accesskey="U">Pysic module</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">HybridCalculator class</a><ul>
<li><a class="reference internal" href="#mechanical-embedding">Mechanical Embedding</a></li>
<li><a class="reference internal" href="#hydrogen-links-in-pysic">Hydrogen links in Pysic</a></li>
<li><a class="reference internal" href="#list-of-methods">List of methods</a></li>
<li><a class="reference internal" href="#full-documentation-of-the-hybridcalculator-class">Full documentation of the HybridCalculator class</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="chargerelaxation class.html"
                        title="previous chapter">ChargeRelaxation class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="subsystem class.html"
                        title="next chapter">Subsystem class</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/hybridcalculator class.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="hybridcalculator-class"></span><div class="section" id="hybridcalculator-class-description">
<span id="id1"></span><h1>HybridCalculator class<a class="headerlink" href="#hybridcalculator-class-description" title="Permalink to this headline">¶</a></h1>
<p>The HybridCalculator provides a regular ASE calculator interface, but internally combines results from multiple different calculators and interactions between them. Currently you can use it for potential energy and force calculations (stress calculations not yet implemented). Like with any ASE calculator, you can also run molecular dynamics and local geometry optimizations with it, but global energy optimization schemes that require a stress implementation will naturally not work due to missing stress implementation.</p>
<p>The following figure demonstrates the simplified workflow comparison of a regular ASE calculation vs. Pysic&#8217;s hybrid QM/MM calculation.</p>
<a class="reference internal image-reference" href="_images/workflow.png"><img alt="_images/workflow.png" class="align-center" src="_images/workflow.png" /></a>
<p>HybridCalculator is meant to be used in conjunction with the classes <a class="reference internal" href="subsystem class.html#pysic.subsystem.SubSystem" title="pysic.subsystem.SubSystem"><tt class="xref py py-class docutils literal"><span class="pre">SubSystem</span></tt></a> and <a class="reference internal" href="interaction class.html#pysic.interaction.Interaction" title="pysic.interaction.Interaction"><tt class="xref py py-class docutils literal"><span class="pre">Interaction</span></tt></a>.
See also the <a class="reference internal" href="run examples.html#hybrid-calculation"><em>run example</em></a>.</p>
<div class="section" id="mechanical-embedding">
<span id="id2"></span><h2>Mechanical Embedding<a class="headerlink" href="#mechanical-embedding" title="Permalink to this headline">¶</a></h2>
<p>The electrostatic interaction between subsystems is treated with the mechanical embedding scheme. The Coulomb interaction is thus calculated in the MM level by assigning point charges for the atoms in the  primary and secondary system. The charges in the secondary system are static and can be obtained from experimental data or theoretical calculations. Rather than also parametrizing the charges in the primary system, in Pysic they can be dynamically calculated by using the electron density provided by the DFT calculator. The positive charge of the nuclei can be accurately modeled as an atom-centered point charge. The effect of the negative electron charge density is approximated also as a single atom-centered point charge. The value of this point charge is calculated by integrating the electron charge density inside a certain volume. Primarily Pysic uses the Bader partitioning scheme to determine these volumes, but a spherical partitioning scheme is also available.</p>
</div>
<div class="section" id="hydrogen-links-in-pysic">
<h2>Hydrogen links in Pysic<a class="headerlink" href="#hydrogen-links-in-pysic" title="Permalink to this headline">¶</a></h2>
<p>The covalent bonds between subsystems are treated with the link atom approach, i.e. hydrogen atoms are used to cap the bonds in the primary QM system. The hydrogen link atoms are placed on the line connecting the two atoms that form the bond. The exact position of the link atoms in this line can be controlled with the CHL parameter, given when defining the links in <tt class="xref py py-meth docutils literal"><span class="pre">add_hydrogen_links()</span></tt>. The link atoms automatically keep their correct position when running dynamics or geometry optimization.</p>
</div>
<div class="section" id="list-of-methods">
<span id="hybridcalculator-class-autogenerated"></span><h2>List of methods<a class="headerlink" href="#list-of-methods" title="Permalink to this headline">¶</a></h2>
<p>The following methods form the basis for creating and performing hybrid simulations with HybridCalculator:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.add_subsystem" title="pysic.hybridcalculator.HybridCalculator.add_subsystem"><tt class="xref py py-meth docutils literal"><span class="pre">add_subsystem()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.add_interaction" title="pysic.hybridcalculator.HybridCalculator.add_interaction"><tt class="xref py py-meth docutils literal"><span class="pre">add_interaction()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.get_potential_energy" title="pysic.hybridcalculator.HybridCalculator.get_potential_energy"><tt class="xref py py-meth docutils literal"><span class="pre">get_potential_energy()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.get_forces" title="pysic.hybridcalculator.HybridCalculator.get_forces"><tt class="xref py py-meth docutils literal"><span class="pre">get_forces()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.print_energy_summary" title="pysic.hybridcalculator.HybridCalculator.print_energy_summary"><tt class="xref py py-meth docutils literal"><span class="pre">print_energy_summary()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.print_force_summary" title="pysic.hybridcalculator.HybridCalculator.print_force_summary"><tt class="xref py py-meth docutils literal"><span class="pre">print_force_summary()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.print_time_summary" title="pysic.hybridcalculator.HybridCalculator.print_time_summary"><tt class="xref py py-meth docutils literal"><span class="pre">print_time_summary()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.print_interaction_charge_summary" title="pysic.hybridcalculator.HybridCalculator.print_interaction_charge_summary"><tt class="xref py py-meth docutils literal"><span class="pre">print_interaction_charge_summary()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.view_subsystems" title="pysic.hybridcalculator.HybridCalculator.view_subsystems"><tt class="xref py py-meth docutils literal"><span class="pre">view_subsystems()</span></tt></a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="full-documentation-of-the-hybridcalculator-class">
<h2>Full documentation of the HybridCalculator class<a class="headerlink" href="#full-documentation-of-the-hybridcalculator-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pysic.hybridcalculator.HybridCalculator">
<em class="property">class </em><tt class="descclassname">pysic.hybridcalculator.</tt><tt class="descname">HybridCalculator</tt><big>(</big><em>atoms=None</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to create and perform hybrid calculations.</p>
<p>This class is a fully compatible ASE calculator that provides the
possibility of dividing the Atoms object into subsystems with different ASE
calculators attached to them.</p>
<p>You can also define hydrogen link atoms in the interfaces of these
subsystems or define any Pysic Potentials through which the subsystems
interact with each other.</p>
<dl class="docutils">
<dt>Attributes:</dt>
<dd><dl class="first last docutils">
<dt>total_timer: :class:&#8217;~pysic.utility.timer.Timer&#8217;</dt>
<dd>Keeps track of the total time spent in the calculations.</dd>
<dt>subsystem_energies: dictionary</dt>
<dd>Name to energy.</dd>
<dt>subsystems: dictionary</dt>
<dd>Name to SubSystemInternal.</dd>
<dt>subsystem_interactions: dictionary</dt>
<dd>Pair of names to InteractionInternal.</dd>
<dt>subsystem_info: dictionary</dt>
<dd>Name to SubSystem.</dd>
<dt>interaction_info: dictionary</dt>
<dd>Pair of names to Interaction.</dd>
<dt>forces: numpy array</dt>
<dd><ul class="first last simple">
<li></li>
</ul>
</dd>
<dt>stress: None</dt>
<dd><ul class="first last simple">
<li></li>
</ul>
</dd>
<dt>potential_energy: float</dt>
<dd><ul class="first last simple">
<li></li>
</ul>
</dd>
<dt>system_initialized: bool</dt>
<dd>Indicates whether the SubSystemInternals and InteractionInternals
have been constructed.</dd>
<dt>self.atoms: ASE Atoms</dt>
<dd>The full system.</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.add_interaction">
<tt class="descname">add_interaction</tt><big>(</big><em>interaction</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.add_interaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.add_interaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to add a interaction between two subsystems.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>interaction: Interaction</dt>
<dd>The Interaction object containing the information.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.add_subsystem">
<tt class="descname">add_subsystem</tt><big>(</big><em>subsystem</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.add_subsystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.add_subsystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to define subsystems</p>
<p>You can define a subsystem with a oneliner, or then call setters on the
SubSystemInfo object returned by this function.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd>subsystem: SubSystem object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.calculate_forces">
<tt class="descname">calculate_forces</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.calculate_forces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.calculate_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the forces in the current structure.</p>
<p>This force includes the forces internal to the subsystems and the forces
that bind the subsystems together.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.calculate_potential_energy">
<tt class="descname">calculate_potential_energy</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.calculate_potential_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.calculate_potential_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the potential energy in the current structure.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.calculate_subsystem_interaction_charges">
<tt class="descname">calculate_subsystem_interaction_charges</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.calculate_subsystem_interaction_charges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.calculate_subsystem_interaction_charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the calculated interaction charges for the given subsystem.</p>
<p>Before the charges can be calulated, one energy calculation has to be
made so that the electron density is available</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.calculation_required">
<tt class="descname">calculation_required</tt><big>(</big><em>atoms, quantities=['forces', 'energy', 'stress']</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.calculation_required"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.calculation_required" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a calculation is required for any of the the given
properties.</p>
<p>Check if the quantities in the quantities list have already been
calculated for the atomic configuration atoms. The quantities can be
one or more of: &#8216;energy&#8217;, &#8216;forces&#8217;, &#8216;stress&#8217;.  This method is used to
check if a quantity is available without further calculations. For this
reason, calculators should react to unknown/unsupported quantities by
returning True, indicating that the quantity is not available.</p>
<p>Two sets of atoms are considered identical if they have the same
positions, atomic numbers, unit cell and periodic boundary conditions.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>atoms: ASE Atoms</dt>
<dd>This structure is compared to the currently stored.</dd>
<dt>quantities: list of strings</dt>
<dd>list of keywords &#8216;energy&#8217;, &#8216;forces&#8217;, &#8216;stress&#8217;</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>bool: True if the quantities need to be calculated, false otherwise.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.check_subsystem_indices">
<tt class="descname">check_subsystem_indices</tt><big>(</big><em>atom_indices</em>, <em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.check_subsystem_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.check_subsystem_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the atomic indices of the subsystem are present.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.check_subsystem_overlap">
<tt class="descname">check_subsystem_overlap</tt><big>(</big><em>atom_indices</em>, <em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.check_subsystem_overlap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.check_subsystem_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the subsystem doesn&#8217;t overlap with another one.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.full_system_set">
<tt class="descname">full_system_set</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.full_system_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.full_system_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the full system has been defined.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.generate_subsystem_indices">
<tt class="descname">generate_subsystem_indices</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.generate_subsystem_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.generate_subsystem_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the indices for the given subsystem.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_atoms">
<tt class="descname">get_atoms</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the full system.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_colors">
<tt class="descname">get_colors</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_colors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a color set for AtomEyeViewer with different colours for the
different subsystems.</p>
<p>When the subsystems have been defined with add_subsystem() and the
atoms have been set, this function will return a list of colors for
each atom. The different subsystems have different colours for easy
identification. You can provide this list of colors to an AtomEyeViewer
object for visualization.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_forces">
<tt class="descname">get_forces</tt><big>(</big><em>atoms=None</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_forces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the forces acting on the atoms.</p>
<p>If the atoms parameter is given, it will be used for updating the
structure assigned to the calculator prior to calculating the forces.
Otherwise the structure already associated with the calculator is used.</p>
<p>The calculator checks if the forces have been calculated already via
<a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.calculation_required" title="pysic.hybridcalculator.HybridCalculator.calculation_required"><tt class="xref py py-meth docutils literal"><span class="pre">calculation_required()</span></tt></a>.
If the structure has changed, the forces are calculated using
<a class="reference internal" href="#pysic.hybridcalculator.HybridCalculator.calculate_forces" title="pysic.hybridcalculator.HybridCalculator.calculate_forces"><tt class="xref py py-meth docutils literal"><span class="pre">calculate_forces()</span></tt></a></p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>atoms: ASE Atoms object</dt>
<dd>The structure to calculate the forces on.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_potential_energy">
<tt class="descname">get_potential_energy</tt><big>(</big><em>atoms=None</em>, <em>force_consistent=False</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_potential_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_potential_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the potential energy of the hybrid system.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_stress">
<tt class="descname">get_stress</tt><big>(</big><em>atoms=None</em>, <em>skip_charge_relaxation=False</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_stress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_stress" title="Permalink to this definition">¶</a></dt>
<dd><p>This function has not been implemented.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_subsystem">
<tt class="descname">get_subsystem</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_subsystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_subsystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the ASE Atoms object for a certain subsystem.</p>
<p>The returned subsystem can be used for e.g. visualization or debugging.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_subsystem_indices">
<tt class="descname">get_subsystem_indices</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_subsystem_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_subsystem_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices of the atoms in the subsystem in the full system.</p>
<p>You can ask the indices even if the subsystems have not been
initialized, but the indices of different subsystems may overlap in
this case. If the subsystems have been initialized this function will
only return indices if they are valid.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_subsystem_pseudo_density">
<tt class="descname">get_subsystem_pseudo_density</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_subsystem_pseudo_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_subsystem_pseudo_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the electron pseudo density for the given subsystem.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.get_unsubsystemized_atoms">
<tt class="descname">get_unsubsystemized_atoms</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.get_unsubsystemized_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.get_unsubsystemized_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of indices for the atoms not already in a subsystem.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.identical_atoms">
<tt class="descname">identical_atoms</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.identical_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.identical_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares the given atoms to the stored atoms object. The Atoms are
identical if the positions, atomic numbers, periodic boundary
conditions and cell are the same.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.initialize_interaction">
<tt class="descname">initialize_interaction</tt><big>(</big><em>info</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.initialize_interaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.initialize_interaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a InteractionInternal from the given Interaction.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd>info: Interaction</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.initialize_subsystem">
<tt class="descname">initialize_subsystem</tt><big>(</big><em>info</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.initialize_subsystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.initialize_subsystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a SubsystemInternal from the given Subsystem.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd>info: SubSystem</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.initialize_system">
<tt class="descname">initialize_system</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.initialize_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.initialize_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the subsystems and interactions.</p>
<p>Called once during the lifetime of the calculator. Typically when
calling set_atoms for the first time, or when calculating any
quantity for the first time. If the atoms in the simulation need to be
updated, update_system() is used.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.print_energy_summary">
<tt class="descname">print_energy_summary</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.print_energy_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.print_energy_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a detailed summary of the different energies in the system.
This includes the energies in the subsystems, interaction energies and
possible energy corrections.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.print_force_summary">
<tt class="descname">print_force_summary</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.print_force_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.print_force_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a detailed summary of forces in the system.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.print_interaction_charge_summary">
<tt class="descname">print_interaction_charge_summary</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.print_interaction_charge_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.print_interaction_charge_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a summary of the atomic charges that are used in the
electrostatic interaction between subsystems.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.print_time_summary">
<tt class="descname">print_time_summary</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.print_time_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.print_time_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a detailed summary of the time usage.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.set_atoms">
<tt class="descname">set_atoms</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.set_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.set_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the full system for hybrid calculations.</p>
<p>Use <tt class="xref py py-meth docutils literal"><span class="pre">add_subsystem()</span></tt> for setting up the
subsystems.</p>
<dl class="docutils">
<dt>Parameters:</dt>
<dd><dl class="first last docutils">
<dt>atoms: ASE Atoms</dt>
<dd>The full system.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.subsystem_defined">
<tt class="descname">subsystem_defined</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.subsystem_defined"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.subsystem_defined" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that there is a subsystem with the given name.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.update_system">
<tt class="descname">update_system</tt><big>(</big><em>atoms</em><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.update_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.update_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the subsystem atoms.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.hybridcalculator.HybridCalculator.view_subsystems">
<tt class="descname">view_subsystems</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/hybridcalculator.html#HybridCalculator.view_subsystems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.hybridcalculator.HybridCalculator.view_subsystems" title="Permalink to this definition">¶</a></dt>
<dd><p>Views the subsystems with ASE:s built in viewer.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="subsystem class.html" title="Subsystem class"
             >next</a> |</li>
        <li class="right" >
          <a href="chargerelaxation class.html" title="ChargeRelaxation class"
             >previous</a> |</li>
        <li><a href="index.html">Pysic 0.6 documentation</a> &raquo;</li>
          <li><a href="pysic.html" >Pysic module</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2013, Teemu Hynninen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>