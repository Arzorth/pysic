
============================
Coordinator class
============================

Coordinator is short for 'Coordination Calculator'.

This class provides a utility for calculating and storing atomic
coordination numbers, i.e., the number of neighbors each atom has.
The coordination is needed for bond-order or Tersoff-like potentials,
and so the :class:`~pysic.Potential` entities, which need the coordination
number, have to be joint with a Coordinator.

The Coordinator can be used as a standalone as well for analysis
purposes. However, note that it always operates on the core and so
one must make sure the correct geometry is allocated in the core
through :class:`~pysic.Pysic`.

Cutoffs
-------

In principle, coordination is calculated by checking all atom pairs
and counting which ones are closer to each other than a predefined
limit. However, in order to make the coordination a continuous and 
differentiable function, a continuous cutoff has to be applied.
This is done similarly to the smooth cutoffs used in :class:`~pysic.Potential`
by defining a proximity function which is 1 for small separations and
0 for large distances.

.. math::

   f(r) = \begin{cases} 1, & r < r_\mathrm{soft} \\ \frac{1}{2}\left(1+\cos \pi\frac{r-r_\mathrm{soft}}{r_\mathrm{hard}-r_\mathrm{soft}}\right), & r_\mathrm{soft} < r < r_\mathrm{hard} \\ 0, & r > r_\mathrm{hard} \end{cases}.

Then the coordination of an atom is simply the sum of the proximity functions.

.. math::

   c_i = \sum_{j \ne i} f(r_{ij}).



List of methods
---------------

Below is a list of methods in :class:`~pysic.Coordinator`, grouped according to
the type of functionality.

Parameter handling
__________________

- :meth:`~pysic.Coordinator.get_soft_cutoff`
- :meth:`~pysic.Coordinator.get_hard_cutoff`
- :meth:`~pysic.Coordinator.set_soft_cutoff`
- :meth:`~pysic.Coordinator.set_hard_cutoff`


Coordination numbers
____________________

- :meth:`~pysic.Coordinator.calculate_coordination`
- :meth:`~pysic.Coordinator.get_coordination`

Full documentation of the Coordinator class
-------------------------------------------

.. currentmodule:: pysic
.. autoclass:: Coordinator
   :members:
   :undoc-members:
