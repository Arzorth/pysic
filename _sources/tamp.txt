
                   call core_get_bond_order_gradients(n_atoms,&
                        interaction%pot_index,&
                        index1,& ! atom index
                        1, & ! slot_index
                        bo_gradients(1:3,1:n_atoms,1))

                   ! loop over neighbors and the atom itself to add the contribution of bond order gradients
                   ! - sum_i (nabla_a b_i) * V_i
                   indexB1 = index1
                   call evaluate_energy(1,dummy_sep,dummy_dist,interaction,tmp_energy,atoms(indexB1:indexB1))
                   forces(1:3,index1) = forces(1:3,index1) - tmp_energy*bo_gradients(1:3,indexB1,1)
                   do iB = 1, nbors1%n_neighbors
                      indexB1 = nbors1%neighbors(iB)
                      call evaluate_energy(1,dummy_sep,dummy_dist,interaction,tmp_energy,atoms(indexB1:indexB1))
                      forces(1:3,index1) = forces(1:3,index1) - tmp_energy*bo_gradients(1:3,indexB1,1)
                   end do
