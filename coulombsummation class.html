

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CoulombSummation class &mdash; Pysic 0.6 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Pysic 0.6 documentation" href="index.html" />
    <link rel="up" title="Pysic module" href="pysic.html" />
    <link rel="next" title="Coordinator class" href="coordinator class.html" />
    <link rel="prev" title="ProductPotential class" href="productpotential class.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="coordinator class.html" title="Coordinator class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="productpotential class.html" title="ProductPotential class"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pysic 0.6 documentation</a> &raquo;</li>
          <li><a href="pysic.html" accesskey="U">Pysic module</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">CoulombSummation class</a><ul>
<li><a class="reference internal" href="#charge-scaling">Charge scaling</a></li>
<li><a class="reference internal" href="#automatic-parameters">Automatic parameters</a></li>
<li><a class="reference internal" href="#list-of-currently-available-summation-algorithms">List of currently available summation algorithms</a><ul>
<li><a class="reference internal" href="#ewald-summation">Ewald summation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#list-of-methods">List of methods</a><ul>
<li><a class="reference internal" href="#initialization">Initialization</a></li>
<li><a class="reference internal" href="#parameter-handling">Parameter handling</a></li>
<li><a class="reference internal" href="#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li><a class="reference internal" href="#full-documentation-of-the-coulombsummation-class">Full documentation of the CoulombSummation class</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="productpotential class.html"
                        title="previous chapter">ProductPotential class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="coordinator class.html"
                        title="next chapter">Coordinator class</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/coulombsummation class.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="coulombsummation-class"></span><span class="target" id="module-pysic.interactions.coulomb"><span id="coulombsummation-class-description"></span></span><div class="section" id="id1">
<h1>CoulombSummation class<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>If a periodic system contains charges interacting via the <span class="math">\(\frac{1}{r}\)</span> Coulomb potential, direct summation of the interactions</p>
<blockquote>
<div><div class="math" id="equation-direct_sum">
<span class="eqno">(1)</span>\[E = \sum_{(i,j)} \frac{1}{4\pi\epsilon_0}\frac{q_i q_j}{r_{ij}},\]</div>
</div></blockquote>
<p>where the sum is over pairs of charges <span class="math">\(q_i, q_j\)</span> (charges of the entire system, not just the simulation cell) and the distance between the charges is <span class="math">\(r_{ij} = |\mathbf{r}_j - \mathbf{r}_i|\)</span>, does not work in general because the sum <a href="#equation-direct_sum">(1)</a> converges very slowly (it actually converges only conditionally). Therefore truncating the sum may lead to severe errors. More advanced techniques must be used in order to accurately evaluate such sums.</p>
<p>This class represents the algorithms used for evaluating the <span class="math">\(1/r\)</span> sums. It wraps the summation parameters and activates the summation of Coulomb interactions. If an instance of <a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation" title="pysic.interactions.coulomb.CoulombSummation"><tt class="xref py py-class docutils literal"><span class="pre">CoulombSummation</span></tt></a> is given to the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> calculator, Coulomb interactions between all charged atoms are automatically included in the calculations, regardless of possible <a class="reference internal" href="potential class.html#pysic.interactions.local.Potential" title="pysic.interactions.local.Potential"><tt class="xref py py-class docutils literal"><span class="pre">Potential</span></tt></a> potentials the calculator may also contain. Otherwise the charges do not directly interact. This is due to two reasons: First, the direct Coulomb interaction is usually always required and it is convenient that it is easily enabled. Second, the specific potentials described by <a class="reference internal" href="potential class.html#pysic.interactions.local.Potential" title="pysic.interactions.local.Potential"><tt class="xref py py-class docutils literal"><span class="pre">Potential</span></tt></a> are evaluated by direct summation and so the Coulomb summation is separate also on algorithm level in the core.</p>
<div class="section" id="charge-scaling">
<span id="coulomb-scaling"></span><h2>Charge scaling<a class="headerlink" href="#charge-scaling" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, you may want to scale the effective charges before calculating the Coulomb sum. Especially, you may want to exclude some atoms from the long range summation. This can be done by giving the <a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation" title="pysic.interactions.coulomb.CoulombSummation"><tt class="xref py py-class docutils literal"><span class="pre">CoulombSummation</span></tt></a> a list of scaling values, one per atom. The actual charges of the atoms are then multiplied by the given scaling values before the Coulomb potential is calculated. If a scaling value is 0, the corresponding atom is always treated as if it had no charge. Note though, that  scaling with unequal scaling constants may lead to the cell being effectively charged.</p>
<p>Using the Python <a class="reference external" href="http://docs.python.org/tutorial/datastructures.html#functional-programming-tools">map</a> function is a convenient way to generate such atom-by-atom lists. For instance, if you want to generate a list by element:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="s">&#39;H2O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">charge_by_elem</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="s">&#39;H&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mf">0.1</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="n">elem</span> <span class="o">==</span> <span class="s">&#39;O&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="o">-</span><span class="mf">0.2</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mf">0.0</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">set_initial_charges</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">charge_by_elem</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">charges</span>
<span class="go">[0.1, 0.1, -0.2]</span>
</pre></div>
</div>
</div>
<div class="section" id="automatic-parameters">
<span id="coulomb-parameters"></span><h2>Automatic parameters<a class="headerlink" href="#automatic-parameters" title="Permalink to this headline">¶</a></h2>
<p>As the summation algorithms are parameter dependent, one should always check numeric convergence before real simulations.
As a first guess, the utility function <a class="reference internal" href="#pysic.interactions.coulomb.estimate_ewald_parameters" title="pysic.interactions.coulomb.estimate_ewald_parameters"><tt class="xref py py-func docutils literal"><span class="pre">pysic.interactions.coulomb.estimate_ewald_parameters()</span></tt></a> can be used for estimating the parameters of the Ewald method.</p>
</div>
<div class="section" id="list-of-currently-available-summation-algorithms">
<span id="list-of-summation-modes"></span><h2>List of currently available summation algorithms<a class="headerlink" href="#list-of-currently-available-summation-algorithms" title="Permalink to this headline">¶</a></h2>
<p>Below is a list of summation algorithms currently implemented.</p>
<div class="section" id="ewald-summation">
<span id="id2"></span><h3>Ewald summation<a class="headerlink" href="#ewald-summation" title="Permalink to this headline">¶</a></h3>
<p>The standard technique for overcoming the problem of summing long ranged periodic potentials is the so called Ewald summation method. The idea is to split the long ranged and singular Coulomb potential to a short ranged singular and long ranged smooth parts, and calculate the long ranged part in reciprocal space via Fourier transformations. This is possible (for a smooth potential) since the system is periodic and the same supercell repeats infinitely in all directions. In practice the calculation can be done by adding (and subtracting) Gaussian charge densities over the point charges to screen the potential in real space. That is, the original charge density <span class="math">\(\rho(\mathbf{r}) = \sum_i q_i \delta(\mathbf{r} - \mathbf{r}_i)\)</span> is split by</p>
<blockquote>
<div><div class="math">
\[\begin{eqnarray}
\rho(\mathbf{r}) & = & \rho_s(\mathbf{r}) + \rho_l(\mathbf{r}) \\
\rho_s(\mathbf{r}) & = & \sum_i \left[ q_i \delta(\mathbf{r} - \mathbf{r}_i) - q_i G_\sigma(\mathbf{r} - \mathbf{r}_i) \right] \\
\rho_l(\mathbf{r}) & = & \sum_i q_i G_\sigma(\mathbf{r} - \mathbf{r}_i) \\
G_\sigma(\mathbf{r}) & = & \frac{1}{(2 \pi \sigma^2)^{3/2}} \exp\left( -\frac{|\mathbf{r}|^2}{2 \sigma^2} \right)
\end{eqnarray}\]</div></div></blockquote>
<p>Here <span class="math">\(\rho_l\)</span> generates a long range interaction since at large distances the Gaussian densities <span class="math">\(G_\sigma\)</span> appear the same as point charges (<span class="math">\(\lim_{\sigma/r \to 0} G_\sigma(\mathbf{r}) = \delta(\mathbf{r})\)</span>). Since the charge density is smooth, so will be the potential it creates. The density <span class="math">\(\rho_s\)</span> exhibits short ranged interactions for the same reason: At distances longer than the width of the Gaussians the point charges are screened by the Gaussians which exactly cancel them (<span class="math">\(\lim_{\sigma/r \to 0} \delta(\mathbf{r}) - G_\sigma(\mathbf{r}) = 0\)</span>).</p>
<p>The short ranged interactions are directly calculated in real space</p>
<blockquote>
<div><div class="math">
\[\begin{eqnarray}
E_s & = & \frac{1}{4 \pi \varepsilon_0} \int \frac{\rho_s(\mathbf{r}) \rho_s(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} \mathrm{d}^3 r \mathrm{d}^3 r' \\
    & = & \frac{1}{4 \pi \varepsilon_0} \sum_{(i,j)} \frac{q_i q_j}{r_{ij}} \mathrm{erfc} \left( \frac{r_{ij}}{\sigma \sqrt{2}} \right) - \frac{1}{4 \pi \varepsilon_0} \frac{1}{\sqrt{2 \pi} \sigma} \sum_i^N q_i^2.
\end{eqnarray}\]</div></div></blockquote>
<p>The complementary error function <span class="math">\(\mathrm{erfc}(r) = 1 - \mathrm{erf}(r) = 1 - \frac{2}{\sqrt{\pi}} \int_0^r e^{-t^2/2} \mathrm{d}t\)</span> makes the sum converge rapidly as <span class="math">\(\frac{r_{ij}}{\sigma} \to \infty\)</span>. The latter sum is the self energy of each point charge in the potential of the particular Gaussian that screens the charge, and the sum runs over all charges in the supercell spanning the periodic system. (The self energy is cancelled by the long range part of the energy.)</p>
<p>The long ranged interaction</p>
<div class="math">
\[E_l = \frac{1}{4 \pi \varepsilon_0} \int \frac{\rho_l(\mathbf{r}) \rho_l(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} \mathrm{d}^3 r \mathrm{d}^3 r'\]</div>
<p>can be calculated in reciprocal space by Fourier transformation. The result is</p>
<blockquote>
<div><div class="math">
\[\begin{eqnarray}
E_l & = & \frac{1}{2 V \varepsilon_0} \sum_{\mathbf{k} \ne 0} \frac{e^{-\sigma^2 k^2 / 2}}{k^2} |S(\mathbf{k})|^2 \\
S(\mathbf{k}) & = & \sum_i^N q_i e^{\mathrm{i} \mathbf{k} \cdot \mathbf{r}_i}
\end{eqnarray}\]</div></div></blockquote>
<p>The sum in <span class="math">\(E_l\)</span> runs over the reciprocal lattice <span class="math">\(\mathbf{k} = k_1 \mathbf{b}_1 + k_2 \mathbf{b}_2 + k_3 \mathbf{b}_3\)</span> where <span class="math">\(\mathbf{b}_i\)</span> are the vectors spanning the reciprocal cell (<span class="math">\([\mathbf{b}_1 \mathbf{b}_2 \mathbf{b}_3] = ([\mathbf{v}_1 \mathbf{v}_2 \mathbf{v}_3]^{-1})^T\)</span> where <span class="math">\(\mathbf{v}_i\)</span> are the real space cell vectors). Likewise the sum in the structure factor <span class="math">\(S(\mathbf{k})\)</span> runs over all charges in the supercell.</p>
<p>The total energy is then the sum of the short and long range energies</p>
<blockquote>
<div><div class="math">
\[E = E_s + E_l.\]</div>
</div></blockquote>
<p>If the system carries a net charge, the total Coulomb potential of the infinite periodic system is infinite. Excess charge can be neutralized by imposing a uniform background charge of opposite sign, which results in the correction term</p>
<div class="math">
\[E_c = - \frac{\sigma^2}{4 V \varepsilon_0} \left| \sum_i q_i \right|^2.\]</div>
<p>This correction is applied automatically.</p>
<p>Forces are obtained as the gradient of the total energy. For atom <span class="math">\(\alpha\)</span>, the force is</p>
<div class="math">
\[\mathbf{F}_\alpha = - \nabla_\alpha E = - \nabla_\alpha E_s - \nabla_\alpha E_l.\]</div>
<p>(There is no contribution from <span class="math">\(E_c\)</span>.)
The short ranged interactions are easily calculated in real space</p>
<div class="math">
\[- \nabla_\alpha E_s = \frac{q_\alpha}{4 \pi \varepsilon_0} \sum_{j} q_j \left[ \mathrm{erfc} \left( \frac{r_{\alpha j}}{\sigma \sqrt{2}} \right) \frac{1}{r_{\alpha j}^2}  + \frac{1}{\sigma} \sqrt{\frac{2}{\pi}} \exp\left( -\frac{r_{\alpha j}^2}{2 \sigma^2} \right) \frac{1}{r_{\alpha j}} \right] \hat{r}_{\alpha j},\]</div>
<p>where <span class="math">\(\hat{r}_{\alpha j} = \mathbf{r}_{\alpha j} / r_{\alpha j}\)</span> is the unit vector pointing from atom <span class="math">\(\alpha\)</span> to <span class="math">\(j\)</span>.
The long range forces are obtained by differentiating the structure factor</p>
<div class="math">
\[\begin{eqnarray}
- \nabla_\alpha E_l & = &- \frac{1}{2 V \varepsilon_0} \sum_{\mathbf{k} \ne 0} \frac{e^{-\sigma^2 k^2 / 2}}{k^2} 2 \mathrm{Re} [ S^*(\mathbf{k}) \nabla_\alpha S(\mathbf{k}) ] \\
\nabla_\alpha S(\mathbf{k}) & = & q_\alpha \mathbf{k} (- \sin \mathbf{k} \cdot \mathbf{r}_\alpha + i \cos \mathbf{k} \cdot \mathbf{r}_\alpha ).
\end{eqnarray}\]</div></div>
</div>
<div class="section" id="list-of-methods">
<span id="coulombsummation-class-autogenerated"></span><h2>List of methods<a class="headerlink" href="#list-of-methods" title="Permalink to this headline">¶</a></h2>
<p>Below is a list of methods in <a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation" title="pysic.interactions.coulomb.CoulombSummation"><tt class="xref py py-class docutils literal"><span class="pre">CoulombSummation</span></tt></a>, grouped according to
the type of functionality.</p>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.initialize_parameters" title="pysic.interactions.coulomb.CoulombSummation.initialize_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">initialize_parameters()</span></tt></a> (meant for internal use)</li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.get_summation" title="pysic.interactions.coulomb.CoulombSummation.get_summation"><tt class="xref py py-meth docutils literal"><span class="pre">get_summation()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.set_summation" title="pysic.interactions.coulomb.CoulombSummation.set_summation"><tt class="xref py py-meth docutils literal"><span class="pre">set_summation()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.summation_modes" title="pysic.interactions.coulomb.CoulombSummation.summation_modes"><tt class="xref py py-data docutils literal"><span class="pre">summation_modes</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.summation_parameter_descriptions" title="pysic.interactions.coulomb.CoulombSummation.summation_parameter_descriptions"><tt class="xref py py-data docutils literal"><span class="pre">summation_parameter_descriptions</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.summation_parameters" title="pysic.interactions.coulomb.CoulombSummation.summation_parameters"><tt class="xref py py-data docutils literal"><span class="pre">summation_parameters</span></tt></a></li>
</ul>
</div>
<div class="section" id="parameter-handling">
<h3>Parameter handling<a class="headerlink" href="#parameter-handling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.get_parameters" title="pysic.interactions.coulomb.CoulombSummation.get_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">get_parameters()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.set_parameter_value" title="pysic.interactions.coulomb.CoulombSummation.set_parameter_value"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameter_value()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.set_parameter_values" title="pysic.interactions.coulomb.CoulombSummation.set_parameter_values"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameter_values()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.set_parameters" title="pysic.interactions.coulomb.CoulombSummation.set_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameters()</span></tt></a></li>
</ul>
</div>
<div class="section" id="miscellaneous">
<h3>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.get_realspace_cutoff" title="pysic.interactions.coulomb.CoulombSummation.get_realspace_cutoff"><tt class="xref py py-meth docutils literal"><span class="pre">get_realspace_cutoff()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.get_scaling_factors" title="pysic.interactions.coulomb.CoulombSummation.get_scaling_factors"><tt class="xref py py-meth docutils literal"><span class="pre">get_scaling_factors()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.set_scaling_factors" title="pysic.interactions.coulomb.CoulombSummation.set_scaling_factors"><tt class="xref py py-meth docutils literal"><span class="pre">set_scaling_factors()</span></tt></a></li>
</ul>
</div>
</div>
<div class="section" id="full-documentation-of-the-coulombsummation-class">
<h2>Full documentation of the CoulombSummation class<a class="headerlink" href="#full-documentation-of-the-coulombsummation-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pysic.interactions.coulomb.CoulombSummation">
<em class="property">class </em><tt class="descclassname">pysic.interactions.coulomb.</tt><tt class="descname">CoulombSummation</tt><big>(</big><em>method='ewald'</em>, <em>parameters=None</em>, <em>scaler=None</em><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for representing a collection of parameters for evaluating Coulomb potentials.</p>
<p>Summing <span class="math">\(1/r\)</span> potentials in periodic systems requires more 
advanced techniques than just direct summation of pair interactions.
The starndard method for evaluating these kinds of potentials is through
Ewald summation, where the long range part of the potential is evaluated
in reciprocal space.</p>
<p>Instances of this class are used for wrapping the parameters controlling
the summations. Passing such an instance to the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a>
calculator activates the evaluation of Coulomb interactions.</p>
<p>Currently, only Ewald summation is available as a calculation method.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>method: string</dt>
<dd>keyword specifying the method of summation</dd>
<dt>parameters: list of doubles</dt>
<dd>numeric values of summation parameters</dd>
<dt>scaler: list of doubles</dt>
<dd>numeric values for scaling the atomic charges in summation</dd>
</dl>
<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.get_parameters">
<tt class="descname">get_parameters</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.get_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.get_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list containing the numeric values of the parameters.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.get_realspace_cutoff">
<tt class="descname">get_realspace_cutoff</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.get_realspace_cutoff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.get_realspace_cutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the real space cutoff.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.get_scaling_factors">
<tt class="descname">get_scaling_factors</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.get_scaling_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.get_scaling_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of scaling parameters for atomic charges.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.get_summation">
<tt class="descname">get_summation</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.get_summation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.get_summation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mode of summation.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.initialize_parameters">
<tt class="descname">initialize_parameters</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.initialize_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.initialize_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dictionary of parameters and initializes all values to 0.0.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.set_parameter_value">
<tt class="descname">set_parameter_value</tt><big>(</big><em>parameter_name</em>, <em>value</em><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.set_parameter_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.set_parameter_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a given parameter to the desired value.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>parameter_name: string</dt>
<dd>name of the parameter</dd>
<dt>value: double</dt>
<dd>the new value of the parameter</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.set_parameter_values">
<tt class="descname">set_parameter_values</tt><big>(</big><em>parameters</em><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.set_parameter_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.set_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the numeric values for all parameters.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>parameters: list of doubles</dt>
<dd>list of values to be assigned to parameters</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.set_parameters">
<tt class="descname">set_parameters</tt><big>(</big><em>parameters</em><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.set_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the numeric values for all parameters.</p>
<p>Equivalent to <tt class="xref py py-meth docutils literal"><span class="pre">set_parameter_values()</span></tt></p>
<p>Parameters:</p>
<dl class="docutils">
<dt>parameters: list of doubles</dt>
<dd>list of values to be assigned to parameters</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.set_scaling_factors">
<tt class="descname">set_scaling_factors</tt><big>(</big><em>scaler</em><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.set_scaling_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.set_scaling_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the list of scaling parameters for atomic charges.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>scaler: list of doubles</dt>
<dd>the list of scaling factors</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.interactions.coulomb.CoulombSummation.set_summation">
<tt class="descname">set_summation</tt><big>(</big><em>method</em><big>)</big><a class="reference internal" href="_modules/pysic/interactions/coulomb.html#CoulombSummation.set_summation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.set_summation" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the summation method.</p>
<p>The method also creates a dictionary of parameters initialized to 0.0
by invoking <a class="reference internal" href="#pysic.interactions.coulomb.CoulombSummation.initialize_parameters" title="pysic.interactions.coulomb.CoulombSummation.initialize_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">initialize_parameters()</span></tt></a>.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>method: string</dt>
<dd>a keyword specifying the mode of summation</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pysic.interactions.coulomb.CoulombSummation.summation_modes">
<tt class="descname">summation_modes</tt><em class="property"> = ['ewald']</em><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.summation_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of the summation methods. These are keywords used for setting up the summation algorithms.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysic.interactions.coulomb.CoulombSummation.summation_parameter_descriptions">
<tt class="descname">summation_parameter_descriptions</tt><em class="property"> = {'ewald': ['real space cutoff radius', 'reciprocal space cutoff radius', 'ewald summation split parameter', 'vacuum permittivity']}</em><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.summation_parameter_descriptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Short descriptions of the parameters of the summation algorithm.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysic.interactions.coulomb.CoulombSummation.summation_parameters">
<tt class="descname">summation_parameters</tt><em class="property"> = {'ewald': ['real_cutoff', 'k_cutoff', 'sigma', 'epsilon']}</em><a class="headerlink" href="#pysic.interactions.coulomb.CoulombSummation.summation_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of the parameters of the summation algorithm.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pysic.interactions.coulomb.estimate_ewald_parameters">
<tt class="descclassname">pysic.interactions.coulomb.</tt><tt class="descname">estimate_ewald_parameters</tt><big>(</big><em>real_cutoff=10.0</em>, <em>accuracy='normal'</em><big>)</big><a class="headerlink" href="#pysic.interactions.coulomb.estimate_ewald_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple containing a good initial guess for Ewald parameters in the order <cite>real_cutoff, k_cutoff, sigma, epsilon</cite>.</p>
<p>The returned values are (real_cutoff, k_cutoff, sigma, epsilon).
Epsilon is always 0.00552635 <span class="math">\(\varepsilon_0\)</span> in units of <span class="math">\(\frac{e^2}{eV A}\)</span>
Real cutoff can be given by the user and should be short enough to make the
real space summation efficient (note that this affects neighborlisting and thus
also other real space summations). Sigma and k_cutoff are determined by simple scaling rules
where <span class="math">\(\sigma \sim r_\mathrm{cut}\)</span> and <span class="math">\(k_\mathrm{cut} \sim \sigma^{-1}\)</span>.
The scaling constants are determined by the accuracy setting.</p>
<p>Note that the given parameters are not analysed in any way - they are only a first guess.
You should always test the parameters for accuracy and speed before production simulations.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>real_cutoff: double</dt>
<dd>the real space cutoff to be used - it should be shorter than the size of the simulation box</dd>
<dt>accuracy: string</dt>
<dd>either &#8216;low&#8217;, &#8216;normal&#8217;, &#8216;high&#8217;, &#8216;real&#8217; or &#8216;reciprocal&#8217;</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="coordinator class.html" title="Coordinator class"
             >next</a> |</li>
        <li class="right" >
          <a href="productpotential class.html" title="ProductPotential class"
             >previous</a> |</li>
        <li><a href="index.html">Pysic 0.6 documentation</a> &raquo;</li>
          <li><a href="pysic.html" >Pysic module</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2013, Teemu Hynninen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>