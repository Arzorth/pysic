

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ChargeRelaxation class &mdash; Pysic 0.4.8 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Pysic 0.4.8 documentation" href="index.html" />
    <link rel="up" title="Pysic module" href="pysic.html" />
    <link rel="next" title="FastNeighborList class" href="fastneighborlist class.html" />
    <link rel="prev" title="SuttonChenPotential class" href="suttonchenpotential class.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fastneighborlist class.html" title="FastNeighborList class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="suttonchenpotential class.html" title="SuttonChenPotential class"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pysic 0.4.8 documentation</a> &raquo;</li>
          <li><a href="pysic.html" accesskey="U">Pysic module</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ChargeRelaxation class</a><ul>
<li><a class="reference internal" href="#connecting-the-structure-calculator-and-relaxation-algorithm">Connecting the structure, calculator and relaxation algorithm</a></li>
<li><a class="reference internal" href="#piping-chargerelaxation-algorithms">Piping ChargeRelaxation algorithms</a></li>
<li><a class="reference internal" href="#observers">Observers</a></li>
<li><a class="reference internal" href="#list-of-currently-available-relaxation-methods">List of currently available relaxation methods</a><ul>
<li><a class="reference internal" href="#damped-dynamics">Damped dynamics</a></li>
<li><a class="reference internal" href="#potentiostat">Potentiostat</a></li>
<li><a class="reference internal" href="#optimization">Optimization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#list-of-methods">List of methods</a><ul>
<li><a class="reference internal" href="#initialization">Initialization</a></li>
<li><a class="reference internal" href="#atoms-handling">Atoms handling</a></li>
<li><a class="reference internal" href="#calculator-handling">Calculator handling</a></li>
<li><a class="reference internal" href="#parameter-handling">Parameter handling</a></li>
<li><a class="reference internal" href="#pipe-handling">Pipe handling</a></li>
<li><a class="reference internal" href="#observer-handling">Observer handling</a></li>
<li><a class="reference internal" href="#charge-relaxation">Charge relaxation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#full-documentation-of-the-chargerelaxation-class">Full documentation of the ChargeRelaxation class</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="suttonchenpotential class.html"
                        title="previous chapter">SuttonChenPotential class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fastneighborlist class.html"
                        title="next chapter">FastNeighborList class</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/chargerelaxation class.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="chargerelaxation-class"></span><span class="target" id="module-pysic.charges"><span id="chargerelaxation-class-description"></span></span><span class="target" id="module-pysic.charges.relaxation"></span><div class="section" id="id1">
<h1>ChargeRelaxation class<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>This class controls equilibration of atomic charges in the system.</p>
<p>It is possible for the user to define the charges of atoms in ASE.
If a system exhibits charge transfer, polarization, charged defects etc., one may not know the charges beforehand or the charges may change dynamically during simulation. To handle such systems, it is possible to let the charges in the system develop dynamically.</p>
<p>Since charge dynamics are usually much faster than dynamics of the ions, it is usually reasonable to allow the charges to equilibrate between ionic steps. This does not conserve energy exactly, however, since the charge equilibration drives the system charge distribution towards a lower energy. The energy change in charge redistribution is lost unless it is fed back to the system.</p>
<div class="section" id="connecting-the-structure-calculator-and-relaxation-algorithm">
<span id="connecting-to-pysic"></span><h2>Connecting the structure, calculator and relaxation algorithm<a class="headerlink" href="#connecting-the-structure-calculator-and-relaxation-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Special care must be taken when setting up links between the atomic structure (<a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a>), the calculator (<a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a>), and the charge relaxation algorithm (<a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a>). While some of the objects must know the others, in some cases the behavior of the simulator changes depending on whether or not they have access to the other objects.</p>
<p>The atoms and the calculator are linked as required in the <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/calculators/calculators.html#calculator-interface">ASE calculator interface</a>: One can link the two by either the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic.set_atoms" title="pysic.calculator.Pysic.set_atoms"><tt class="xref py py-meth docutils literal"><span class="pre">set_atoms()</span></tt></a> method of <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a>, or the <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html#ase.atoms.Atoms.set_calculator">set_calculator</a> method of <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a>. In either case, the atomic structure is given a link to the calculator, and a <strong>copy</strong> of the structure is stored in the calculator. This must be done in order to do any calculations on the system.</p>
<p>Also the relaxation algorithm has to know the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> calculator, since the relaxation is done according to the <a class="reference internal" href="potential class.html#pysic.interactions.local.Potential" title="pysic.interactions.local.Potential"><tt class="xref py py-class docutils literal"><span class="pre">Potential</span></tt></a> interactions stored in the calculator. The algorithm can be made to know the calculator via the <tt class="xref py py-meth docutils literal"><span class="pre">set_calculator()</span></tt> method of <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a>. By default, this does not make the calculator know the relaxation algorithm, however. Only if the optional argument <tt class="docutils literal"><span class="pre">reciprocal=True</span></tt> is given the backwards link is also made. <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> can be made to know the relaxation algorithm also by calling the method <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic.set_charge_relaxation" title="pysic.calculator.Pysic.set_charge_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">set_charge_relaxation()</span></tt></a>. Unlike the opposite case, by making the link from the calculator, the backwards link from the relaxation algorithm is always made automatically. In fact, even though linking an algorithm to a calculator does not automatically link the calculator to the algorithm, if a different calculator was linked to the algorithm, the link is automatically removed.</p>
<p>This slightly complicated behavior is summarized as follows: The algorithm should always have a link to a calculator, but a calculator need not have a link to an algorithm. If a calculator does link to an algorithm, the algorithm must link back to the same calculator. Clearly one does not always want to perform charge relaxation on the system and so it makes sense that the calculator need not have a link to a charge relaxation algorithm. If such a link does exist, then the relaxation is <em>automatically</em> invoked prior to each energy and force evaluation. This is necessary in simulations such as molecular dynamics (MD). A charge relaxation can be linked to a calculator in order to do charge equilibration, but if one does not wish to trigger the charge relaxation automatically, then it is enough to just not let the calculator know the relaxation algorithm.</p>
<p>The atomic structure cannot be given a link to the relaxation algorithm since the charge relaxation is not part of the ASE API and so the atoms object does not know how to interact with it. In essence, from the point of view of the structure, the charge relaxation is fully contained in the calculator.</p>
<p>The charge relaxation algorithm always acts on the structure contained in the calculator. The atomic charges of this structure are automatically updated during the relaxation. Since the calculator only stores a copy of the original structure, the original is not updated. This may be desired if, for instance, one wishes to revert back to the original charges. However, during strucural dynamics simulations such as MD, it is necessary that the relaxed charges are saved between structural steps. This is a problem, since structural dynamics are handled by ASE, and ASE invokes the calculation of forces with the original <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a> object. Therefore, if the relaxed charges are not saved, charge relaxation is always started from the original charges, which may be very inefficient. In order to have also the original structure updated automatically, the charge relaxation can be made to know the original structure with <tt class="xref py py-meth docutils literal"><span class="pre">set_atoms()</span></tt>. Note that the structure given to the algorithm is not used in the actual relaxation; the algorithm always works on the structure in the calculator, which may be different. The given structure is merely updated according to the calculation results.</p>
</div>
<div class="section" id="piping-chargerelaxation-algorithms">
<span id="piping-chargerelaxations"></span><h2>Piping ChargeRelaxation algorithms<a class="headerlink" href="#piping-chargerelaxation-algorithms" title="Permalink to this headline">¶</a></h2>
<p>Sometimes the most efficient way to optimize a system is to combine several algorithms or several parameterizations of a single algorithm in a sequence. First, one can run a robust but less efficient algorithm to find a rough solution and follow with a more efficient method to pinpoint the optimum at high precision. For a plain relaxation, this can be done manually. However, if the optimization needs to happen automatically, e.g., between molecular dynamics steps, one needs to combine several ChargeRelaxation objects together. This can be done through the method <tt class="xref py py-meth docutils literal"><span class="pre">add_relaxation_pipe()</span></tt>.</p>
<p>Adding a piped ChargeRelaxation object simply calls the <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.charge_relaxation" title="pysic.charges.relaxation.ChargeRelaxation.charge_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">charge_relaxation()</span></tt></a> methods of both objects one after another when relaxation is invoked. Several objects can be piped by recursive piping. For instance, the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">rel1</span> <span class="o">=</span> <span class="n">ChargeRelaxation</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">rel2</span> <span class="o">=</span> <span class="n">ChargeRelaxation</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">rel3</span> <span class="o">=</span> <span class="n">ChargeRelaxation</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="n">rel1</span><span class="o">.</span><span class="n">add_relaxation_pipe</span><span class="p">(</span><span class="n">rel2</span><span class="p">)</span>
<span class="n">rel2</span><span class="o">.</span><span class="n">add_relaxation_pipe</span><span class="p">(</span><span class="n">rel3</span><span class="p">)</span>
</pre></div>
</div>
<p>creates a pipe <tt class="docutils literal"><span class="pre">rel1</span></tt>-<tt class="docutils literal"><span class="pre">rel2</span></tt>-<tt class="docutils literal"><span class="pre">rel3</span></tt>, where <tt class="docutils literal"><span class="pre">rel1</span></tt> is executed first and <tt class="docutils literal"><span class="pre">rel3</span></tt> last. Creating looped pipes where the same relaxation appears twice is not allowed.</p>
<p>By default, when a pipe is created, the calculator and structure objects of the first relaxation are copied also to all the piped ChargeRelaxation objects (including recursively defined ones).</p>
</div>
<div class="section" id="observers">
<span id="id2"></span><h2>Observers<a class="headerlink" href="#observers" title="Permalink to this headline">¶</a></h2>
<p>Similarly to <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/tutorials/md/md.html">ASE molecular dynamics</a>, also the ChargeRelaxation allows one to attach callback functions to the dynamics. That is, one can have a specific functions be automatically invoked at given intervals. This can be used for instance for printing statistics or saving data during the optimization run. For instance, the following example saves and plots the charge of the atom with index 0:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">system</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">Pysic</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">rel</span> <span class="o">=</span> <span class="n">ChargeRelaxation</span><span class="p">(</span><span class="n">calculator</span> <span class="o">=</span> <span class="n">calc</span><span class="p">,</span> <span class="n">system</span> <span class="o">=</span> <span class="n">system</span><span class="p">)</span>

<span class="n">charge0</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">save_charge</span><span class="p">():</span>
    <span class="n">charge0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">()</span><span class="o">.</span><span class="n">get_charges</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">rel</span><span class="o">.</span><span class="n">add_observer</span><span class="p">(</span><span class="n">save_charge</span><span class="p">)</span>
<span class="n">rel</span><span class="o">.</span><span class="n">charge_relaxation</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">charge0</span><span class="p">))),</span> <span class="n">thecharges</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="list-of-currently-available-relaxation-methods">
<span id="list-of-relaxation-modes"></span><h2>List of currently available relaxation methods<a class="headerlink" href="#list-of-currently-available-relaxation-methods" title="Permalink to this headline">¶</a></h2>
<p>Below is a list of the charge relaxation methods currently implemented.</p>
<div class="section" id="damped-dynamics">
<span id="id3"></span><h3>Damped dynamics<a class="headerlink" href="#damped-dynamics" title="Permalink to this headline">¶</a></h3>
<p>Assigning an inertia, <span class="math">\(M_q\)</span>, on the atomic charges, <span class="math">\(q_i\)</span>, we can describe the system with the Lagrangian</p>
<div class="math">
\[L = \sum_i \frac{1}{2} m_i \dot{\mathbf{r}}_i^2 + \sum_i \frac{1}{2} M_q \dot{q}_i^2 - U(\{q\},\{\mathbf{r}\}) - \nu \sum_i q_i,\]</div>
<p>where <span class="math">\(m_i, \mathbf{r}_i\)</span> are the mass and position of atom <span class="math">\(i\)</span>, respectively. The last term is a Lagrange multiplier corresponding to the constraint of fixed total charge, i.e., <span class="math">\(\sum_i q_i = Q_\mathrm{tot}\)</span> being constant. The total potential energy <span class="math">\(U\)</span> is a function of all charges and positions.</p>
<p>The equations of motion for this system are</p>
<div class="math">
\[\begin{eqnarray}
m_i \ddot{\mathbf{r}}_i & = & -\nabla_i U \\
M_q \ddot{q}_i & = & -\frac{\partial U}{\partial q_i} - \nu.
\end{eqnarray}\]</div><p>In the charge equation, the Lagrange multiplier can be shown to equal the average electronegativity of the system, <span class="math">\(\nu = \bar{\chi}\)</span>, and the derivative is the effective electronegativity of atom <span class="math">\(i\)</span>, <span class="math">\(-\frac{\partial U}{\partial q_i} = \chi_i\)</span>. Thus, the effective force driving the change in atomic charges is the electronegativity difference from the avarage</p>
<div class="math">
\[M_q \ddot{q}_i =  -\frac{\partial U}{\partial q_i} - \nu = \chi_i - \bar{\chi} = \Delta \chi_i.\]</div>
<p>In the damped dynamic equilibration, the charges are developed dynamically according to the equation of motion with an added damping (friction) term <span class="math">\(- \eta \dot{q}_i\)</span></p>
<div class="math" id="equation-charge_equation">
<span class="eqno">(1)</span>\[M_q \ddot{q}_i = \Delta \chi_i - \eta \dot{q}_i.\]</div>
<p>This leads to the charges being driven towards a state where the driving force vanishes <span class="math">\(\Delta \chi_i = 0\)</span>, i.e., the electronegativities are equal.</p>
<p>During simulation such as molecular dynamics or geometry optimization, charge equilibration is done by running the damped charge dynamics <a href="#equation-charge_equation">(1)</a> before each force or energy evaluation.</p>
<p>Keywords:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">names_of_parameters</span><span class="p">(</span><span class="s">&#39;dynamic&#39;</span><span class="p">)</span>
<span class="go">[&#39;n_steps&#39;, &#39;timestep&#39;, &#39;inertia&#39;, &#39;friction&#39;, &#39;tolerance&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="potentiostat">
<span id="id4"></span><h3>Potentiostat<a class="headerlink" href="#potentiostat" title="Permalink to this headline">¶</a></h3>
<p>Similarly to <a class="reference internal" href="#damped-dynamics"><em>Damped dynamics</em></a>, a potentiostat drives the atomic charges <span class="math">\(q_i\)</span>
with the dynamics</p>
<div class="math">
\[\begin{eqnarray}
m_i \ddot{\mathbf{r}}_i & = & -\nabla_i U \\
M_q \ddot{q}_i & = & -\frac{\partial U}{\partial q_i} - \Phi.
\end{eqnarray}\]</div><p>Charge equilibration tries to optimize the charge distribution (with fixed total charge) so that the total energy is minimized. The potentiostat, however, connects the system to an electrode (a charge resevoir) at constant potential <span class="math">\(\Phi\)</span>. This means that the total charge of the system is allowed to change so that the electronegativity of each atom equals the external potential <span class="math">\(\chi_i = -\frac{\partial U}{\partial q_i} = \Phi\)</span>.</p>
<p>Keywords:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">names_of_parameters</span><span class="p">(</span><span class="s">&#39;potentiostat&#39;</span><span class="p">)</span>
<span class="go">[&#39;n_steps&#39;, &#39;timestep&#39;, &#39;inertia&#39;, &#39;potential&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="optimization">
<span id="id5"></span><h3>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h3>
<p>This charge optimization method uses the
<a class="reference external" href="SciPyfmin_slsqphttp://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_slsqp.html">SciPyfmin_slsqphttp://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_slsqp.html</a> function
for constrained optimization using <a class="reference external" href="http://en.wikipedia.org/wiki/Sequential_quadratic_programming">Sequential Least Squares Programming (SLSQP)</a>.</p>
<p>Instead of dynamic simulation, the algorithm searches for energy minimum <span class="math">\(U(\mathbf{q})\)</span> with the constraint of constant charge <span class="math">\(\sum_i q_i = Q\)</span>.</p>
<p>As the external function does not support callback functions, observers cannot be attached to this algorthm.</p>
<p>Keywords:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">names_of_parameters</span><span class="p">(</span><span class="s">&#39;optimize&#39;</span><span class="p">)</span>
<span class="go">[&#39;n_steps&#39;, &#39;tolerance&#39;]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="list-of-methods">
<span id="chargerelaxation-class-autogenerated"></span><h2>List of methods<a class="headerlink" href="#list-of-methods" title="Permalink to this headline">¶</a></h2>
<p>Below is a list of methods in <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a>, grouped according to
the type of functionality.</p>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.initialize_parameters" title="pysic.charges.relaxation.ChargeRelaxation.initialize_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">initialize_parameters()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.get_relaxation" title="pysic.charges.relaxation.ChargeRelaxation.get_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">get_relaxation()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_relaxation" title="pysic.charges.relaxation.ChargeRelaxation.set_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">set_relaxation()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.relaxation_modes" title="pysic.charges.relaxation.ChargeRelaxation.relaxation_modes"><tt class="xref py py-data docutils literal"><span class="pre">relaxation_modes</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.relaxation_parameter_descriptions" title="pysic.charges.relaxation.ChargeRelaxation.relaxation_parameter_descriptions"><tt class="xref py py-data docutils literal"><span class="pre">relaxation_parameter_descriptions</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.relaxation_parameters" title="pysic.charges.relaxation.ChargeRelaxation.relaxation_parameters"><tt class="xref py py-data docutils literal"><span class="pre">relaxation_parameters</span></tt></a></li>
</ul>
</div>
<div class="section" id="atoms-handling">
<h3>Atoms handling<a class="headerlink" href="#atoms-handling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.get_atoms" title="pysic.charges.relaxation.ChargeRelaxation.get_atoms"><tt class="xref py py-meth docutils literal"><span class="pre">get_atoms()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_atoms" title="pysic.charges.relaxation.ChargeRelaxation.set_atoms"><tt class="xref py py-meth docutils literal"><span class="pre">set_atoms()</span></tt></a></li>
</ul>
</div>
<div class="section" id="calculator-handling">
<h3>Calculator handling<a class="headerlink" href="#calculator-handling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.get_calculator" title="pysic.charges.relaxation.ChargeRelaxation.get_calculator"><tt class="xref py py-meth docutils literal"><span class="pre">get_calculator()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_calculator" title="pysic.charges.relaxation.ChargeRelaxation.set_calculator"><tt class="xref py py-meth docutils literal"><span class="pre">set_calculator()</span></tt></a></li>
</ul>
</div>
<div class="section" id="parameter-handling">
<h3>Parameter handling<a class="headerlink" href="#parameter-handling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.get_parameters" title="pysic.charges.relaxation.ChargeRelaxation.get_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">get_parameters()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_parameter_value" title="pysic.charges.relaxation.ChargeRelaxation.set_parameter_value"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameter_value()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_parameter_values" title="pysic.charges.relaxation.ChargeRelaxation.set_parameter_values"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameter_values()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_parameters" title="pysic.charges.relaxation.ChargeRelaxation.set_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameters()</span></tt></a></li>
</ul>
</div>
<div class="section" id="pipe-handling">
<h3>Pipe handling<a class="headerlink" href="#pipe-handling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.clear_relaxation_pipe" title="pysic.charges.relaxation.ChargeRelaxation.clear_relaxation_pipe"><tt class="xref py py-meth docutils literal"><span class="pre">clear_relaxation_pipe()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.get_relaxation_pipe" title="pysic.charges.relaxation.ChargeRelaxation.get_relaxation_pipe"><tt class="xref py py-meth docutils literal"><span class="pre">get_relaxation_pipe()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_relaxation_pipe" title="pysic.charges.relaxation.ChargeRelaxation.set_relaxation_pipe"><tt class="xref py py-meth docutils literal"><span class="pre">set_relaxation_pipe()</span></tt></a></li>
</ul>
</div>
<div class="section" id="observer-handling">
<h3>Observer handling<a class="headerlink" href="#observer-handling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.add_observer" title="pysic.charges.relaxation.ChargeRelaxation.add_observer"><tt class="xref py py-meth docutils literal"><span class="pre">add_observer()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.call_observers" title="pysic.charges.relaxation.ChargeRelaxation.call_observers"><tt class="xref py py-meth docutils literal"><span class="pre">call_observers()</span></tt></a></li>
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.clear_observers" title="pysic.charges.relaxation.ChargeRelaxation.clear_observers"><tt class="xref py py-meth docutils literal"><span class="pre">clear_observers()</span></tt></a></li>
</ul>
</div>
<div class="section" id="charge-relaxation">
<h3>Charge relaxation<a class="headerlink" href="#charge-relaxation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.charge_relaxation" title="pysic.charges.relaxation.ChargeRelaxation.charge_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">charge_relaxation()</span></tt></a></li>
</ul>
</div>
</div>
<div class="section" id="full-documentation-of-the-chargerelaxation-class">
<h2>Full documentation of the ChargeRelaxation class<a class="headerlink" href="#full-documentation-of-the-chargerelaxation-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pysic.charges.relaxation.ChargeRelaxation">
<em class="property">class </em><tt class="descclassname">pysic.charges.relaxation.</tt><tt class="descname">ChargeRelaxation</tt><big>(</big><em>relaxation='dynamic'</em>, <em>calculator=None</em>, <em>parameters=None</em>, <em>atoms=None</em><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for handling charge dynamics and relaxation.</p>
<p>Pysic does not implement molecular dynamics or geometric
optimization since they are handled by ASE.
Conceptually, the structural dynamics of the system are
properties of the atomic geometry and so it makes sense that
they are handled by ASE, which defines the atomic structure
in the first place, in the <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a> class.</p>
<p>On the other hand, charge dynamics are related to the electronic
structure of the system. Since ASE is meant to use methods such as 
density functional theory (DFT) in the calculators is employs, all
electronic properties are left at the responsibilty of the
calculator. This makes sense since in DFT the electron density is 
needed for calculations of forces and energies.</p>
<p>Pysic is not a DFT calculator and there is no electron density
but the atomic charges can be made to develop dynamically. The
ChargeRelaxation class handles these dynamics.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>relaxation: string</dt>
<dd>a keyword specifying the mode of charge relaxation</dd>
<dt>calculator: <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> object</dt>
<dd>a Pysic calculator</dd>
<dt>parameters: list of doubles</dt>
<dd>numeric values for parameters</dd>
<dt>atoms: <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a> object</dt>
<dd>The system whose charges are to be relaxed. 
Note! The relaxation is always done using the atoms copy in 
<a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a>, but if the original structure needs to be
updated as well, the relaxation algorithm must have access to it.</dd>
</dl>
<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.add_observer">
<tt class="descname">add_observer</tt><big>(</big><em>function</em>, <em>interval=1</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.add_observer" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach a callback function.</p>
<p>Call the given function with the given arguments at constant
intervals, after a given number of relaxation steps.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>function: Python function</dt>
<dd>the function to be called</dd>
<dt>interval: integer</dt>
<dd>the number of steps between callback</dd>
<dt>args: string</dt>
<dd>arguments for the callback function</dd>
<dt>kwargs: string</dt>
<dd>keyword arguments for the callback function</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.call_observers">
<tt class="descname">call_observers</tt><big>(</big><em>step</em><big>)</big><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.call_observers" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls all the attached callback functions.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>step: integer</dt>
<dd>the number of dynamics steps taken during the relaxation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.charge_relaxation">
<tt class="descname">charge_relaxation</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.charge_relaxation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.charge_relaxation" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the charge relaxation.</p>
<p>The relaxation is always performed on the system associated with
the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> calculator joint with this <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a>.
The calculated equilibrium charges are returned as a numeric array.</p>
<p>If an <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a> structure is known by the
<a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a> 
(given through <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_atoms" title="pysic.charges.relaxation.ChargeRelaxation.set_atoms"><tt class="xref py py-meth docutils literal"><span class="pre">set_atoms()</span></tt></a>), the charges of
the structure are updated according to the calculation result.
If the structure is not known, the charges are updated in the
structure stored in the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> calculator, but not in any other
object. Since <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> only stores a copy of the structure it 
is given, the original <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a> object will not be updated.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.clear_observers">
<tt class="descname">clear_observers</tt><big>(</big><big>)</big><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.clear_observers" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all observers.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.clear_relaxation_pipe">
<tt class="descname">clear_relaxation_pipe</tt><big>(</big><big>)</big><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.clear_relaxation_pipe" title="Permalink to this definition">¶</a></dt>
<dd><p>Equivalent to set_relaxation_pipe(None).</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.get_atoms">
<tt class="descname">get_atoms</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.get_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.get_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the atoms object known by the algorithm.</p>
<p>This is the <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a> which will be automatically updated when
charge relaxation is invoked.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.get_calculator">
<tt class="descname">get_calculator</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.get_calculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.get_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> calculator assigned to this <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.get_parameters">
<tt class="descname">get_parameters</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.get_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.get_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list containing the numeric values of the parameters.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.get_relaxation">
<tt class="descname">get_relaxation</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.get_relaxation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.get_relaxation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keyword specifying the mode of relaxation.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.get_relaxation_pipe">
<tt class="descname">get_relaxation_pipe</tt><big>(</big><em>recursive=True</em><big>)</big><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.get_relaxation_pipe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the piped <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a> objects.</p>
<p>By default, a list is given containing all the ChargeRelaxation objects
in the pipeline (or an empty list).</p>
<p>If called with the argument False, only the ChargeRelaxation next-in-line
will be returned (or None).</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>recursive: boolean</dt>
<dd>If True, will return a list containing all the piped objects. Otherwise, only the next-in-line is returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.initialize_parameters">
<tt class="descname">initialize_parameters</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.initialize_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.initialize_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dictionary of parameters and initializes all values to 0.0.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysic.charges.relaxation.ChargeRelaxation.relaxation_modes">
<tt class="descname">relaxation_modes</tt><em class="property"> = ['dynamic', 'potentiostat', 'optimize']</em><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.relaxation_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of the charge relaxation algorithms available.</p>
<p>These are keywords needed when creating the
<a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a> objects as type specifiers.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysic.charges.relaxation.ChargeRelaxation.relaxation_parameter_descriptions">
<tt class="descname">relaxation_parameter_descriptions</tt><em class="property"> = {'dynamic': ['number of time steps of charge dynamics between molecular dynamics', 'time step of charge dynamics', 'fictional charge mass', 'friction coefficient for damped charge dynamics', 'convergence tolerance'], 'optimize': ['maximum number of optimization steps', 'convergence tolerance'], 'potentiostat': ['number of time steps of charge dynamics between molecular dynamics', 'time step of charge dynamics', 'fictional charge mass', 'external potential']}</em><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.relaxation_parameter_descriptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Short descriptions of the relaxation parameters.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysic.charges.relaxation.ChargeRelaxation.relaxation_parameters">
<tt class="descname">relaxation_parameters</tt><em class="property"> = {'dynamic': ['n_steps', 'timestep', 'inertia', 'friction', 'tolerance'], 'optimize': ['n_steps', 'tolerance'], 'potentiostat': ['n_steps', 'timestep', 'inertia', 'potential']}</em><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.relaxation_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of the parameters of the charge relaxation algorithms.</p>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.set_atoms">
<tt class="descname">set_atoms</tt><big>(</big><em>atoms</em>, <em>pass_to_calculator=False</em><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.set_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.set_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Lets the relaxation algorithm know the atomic structure to be updated.</p>
<p>The relaxation algorithm always works with the structure stored in the
<a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> calculator it knows. If <tt class="docutils literal"><span class="pre">pass_to_calculator</span> <span class="pre">=</span> <span class="pre">True</span></tt>,
this method also updates the structure known by the calculator. However,
this is not the main purpose of letting the <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a>
know the structure -
it is not even necessary that the structure known by the relaxation algorithm
is the same as that known by the calculator.</p>
<p>The structure given to the algorithm is the structure whose charges it 
automatically updates after relaxing the charges in
<a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.charge_relaxation" title="pysic.charges.relaxation.ChargeRelaxation.charge_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">charge_relaxation()</span></tt></a>. In other words, if no
structure is given, the relaxation will update the charges in the strucure
known by <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a>, but this is always just a copy and so the
original structure is left untouched.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>atoms: <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html">ASE Atoms</a> object</dt>
<dd>The system whose charges are to be relaxed. 
Note! The relaxation is always done using the atoms copy in 
<a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a>, but if the original structure needs to be
updated as well, the relaxation algorithm must have access to it.</dd>
<dt>pass_to_calculator: logical</dt>
<dd>if True, the atoms are also set for the calculator via 
<tt class="xref py py-meth docutils literal"><span class="pre">set_atoms()</span></tt></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.set_calculator">
<tt class="descname">set_calculator</tt><big>(</big><em>calculator</em>, <em>reciprocal=False</em><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.set_calculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.set_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns a <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> calculator.</p>
<p>The calculator is necessary for calculation of electronegativities.
It is also possible to automatically assign the charge relaxation
method to the calculator by setting <tt class="docutils literal"><span class="pre">reciprocal</span> <span class="pre">=</span> <span class="pre">True</span></tt>.</p>
<p>Note though
that it does make a difference whether the calculator knows the
charge relaxation or not: If the <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> has a connection
to the <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a>, every time force or energy calculations
are requested the charges are first relaxed by automatically invoking
<a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.charge_relaxation" title="pysic.charges.relaxation.ChargeRelaxation.charge_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">charge_relaxation()</span></tt></a>. If there is no link,
it is up to the user to start the relaxation.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>calculator: <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> object</dt>
<dd>a Pysic calculator</dd>
<dt>reciprocal: logical</dt>
<dd>if True, also the <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a> is passed to the
<a class="reference internal" href="pysic class.html#pysic.calculator.Pysic" title="pysic.calculator.Pysic"><tt class="xref py py-class docutils literal"><span class="pre">Pysic</span></tt></a> through <a class="reference internal" href="pysic class.html#pysic.calculator.Pysic.set_charge_relaxation" title="pysic.calculator.Pysic.set_charge_relaxation"><tt class="xref py py-meth docutils literal"><span class="pre">set_charge_relaxation()</span></tt></a>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.set_parameter_value">
<tt class="descname">set_parameter_value</tt><big>(</big><em>parameter_name</em>, <em>value</em><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.set_parameter_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.set_parameter_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a given parameter to the desired value.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>parameter_name: string</dt>
<dd>name of the parameter</dd>
<dt>value: double</dt>
<dd>the new value of the parameter</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.set_parameter_values">
<tt class="descname">set_parameter_values</tt><big>(</big><em>parameters</em><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.set_parameter_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.set_parameter_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the numeric values for all parameters.</p>
<p>Use get_parameters() to see the correct order of values.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>parameters: list of doubles</dt>
<dd>list of values to be assigned to parameters</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.set_parameters">
<tt class="descname">set_parameters</tt><big>(</big><em>parameters</em><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.set_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the numeric values for all parameters.</p>
<p>Equivalent to <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.set_parameter_values" title="pysic.charges.relaxation.ChargeRelaxation.set_parameter_values"><tt class="xref py py-meth docutils literal"><span class="pre">set_parameter_values()</span></tt></a></p>
<p>Parameters:</p>
<dl class="docutils">
<dt>parameters: list of doubles</dt>
<dd>list of values to be assigned to parameters</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.set_relaxation">
<tt class="descname">set_relaxation</tt><big>(</big><em>relaxation</em><big>)</big><a class="reference internal" href="_modules/pysic/charges/relaxation.html#ChargeRelaxation.set_relaxation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.set_relaxation" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the relaxation method.</p>
<p>The method also creates a dictionary of parameters initialized to 0.0
by invoking <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation.initialize_parameters" title="pysic.charges.relaxation.ChargeRelaxation.initialize_parameters"><tt class="xref py py-meth docutils literal"><span class="pre">initialize_parameters()</span></tt></a>.</p>
<p>Parameters:</p>
<dl class="docutils">
<dt>relaxation: string</dt>
<dd>a keyword specifying the mode of charge relaxation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pysic.charges.relaxation.ChargeRelaxation.set_relaxation_pipe">
<tt class="descname">set_relaxation_pipe</tt><big>(</big><em>relaxation</em>, <em>pass_info=True</em><big>)</big><a class="headerlink" href="#pysic.charges.relaxation.ChargeRelaxation.set_relaxation_pipe" title="Permalink to this definition">¶</a></dt>
<dd><p>Add another <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a> to take place immediately after this relaxation.</p>
<p>Sometimes it is most efficient to start the relaxation with a robust but 
possibly slow algorithm and switch to a more advanced one once closer to
equilibrium. On the other hand, when relaxation is needed between MD steps,
this is not possible manually. Therefore, one can link several ChargeRelaxation
objects together to automatically invoke a sequential relaxation procedure.</p>
<p>You should only give one ChargeRelaxation for piping. If you want to
pipe more than two relaxation sequences together, you should always link the
additional relaxation to the currently final ChargeRelaxation object to
create a nested pipeline:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">rel1</span> <span class="o">=</span> <span class="n">ChargeRelaxation</span><span class="p">()</span>
<span class="n">rel2</span> <span class="o">=</span> <span class="n">ChargeRelaxation</span><span class="p">()</span>
<span class="n">rel3</span> <span class="o">=</span> <span class="n">ChargeRelaxation</span><span class="p">()</span>

<span class="n">rel1</span><span class="o">.</span><span class="n">set_relaxation_pipe</span><span class="p">(</span><span class="n">rel2</span><span class="p">)</span>
<span class="n">rel2</span><span class="o">.</span><span class="n">set_relaxation_pipe</span><span class="p">(</span><span class="n">rel3</span><span class="p">)</span>

<span class="n">rel1</span><span class="o">.</span><span class="n">charge_relaxation</span><span class="p">()</span> <span class="c"># will do rel1 -&gt; rel2 -&gt; rel3</span>
</pre></div>
</div>
<p>Parameters:</p>
<dl class="docutils">
<dt>relaxation: <a class="reference internal" href="#pysic.charges.relaxation.ChargeRelaxation" title="pysic.charges.relaxation.ChargeRelaxation"><tt class="xref py py-class docutils literal"><span class="pre">ChargeRelaxation</span></tt></a> object</dt>
<dd>the relaxation to be piped after this one</dd>
<dt>pass_info: boolean</dt>
<dd>If True, the calculator and atoms of this calculator will be automatically
copied over to the piped calculator.</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fastneighborlist class.html" title="FastNeighborList class"
             >next</a> |</li>
        <li class="right" >
          <a href="suttonchenpotential class.html" title="SuttonChenPotential class"
             >previous</a> |</li>
        <li><a href="index.html">Pysic 0.4.8 documentation</a> &raquo;</li>
          <li><a href="pysic.html" >Pysic module</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2013, Teemu Hynninen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>