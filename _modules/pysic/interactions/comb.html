

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pysic.interactions.comb &mdash; Pysic 0.6 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Pysic 0.6 documentation" href="../../../index.html" />
    <link rel="up" title="pysic" href="../../pysic.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">Pysic 0.6 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../pysic.html" accesskey="U">pysic</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pysic.interactions.comb</h1><div class="highlight"><pre>
<span class="c">#  COMB  POTENTIAL implementation - COMB10 parameters</span>
<span class="c">#</span>
<span class="c"># Teemu Hynninen, Tiziana Musso</span>

<span class="kn">import</span> <span class="nn">pysic</span>
<span class="kn">from</span> <span class="nn">pysic.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pysic.utility.error</span> <span class="kn">import</span> <span class="n">InvalidPotentialError</span>
<span class="kn">from</span> <span class="nn">pysic.interactions.local</span> <span class="kn">import</span> <span class="n">Potential</span><span class="p">,</span> <span class="n">ProductPotential</span>
<span class="kn">from</span> <span class="nn">pysic.interactions.compound</span> <span class="kn">import</span> <span class="n">CompoundPotential</span>
<span class="kn">from</span> <span class="nn">pysic.interactions.bondorder</span> <span class="kn">import</span> <span class="n">Coordinator</span><span class="p">,</span> <span class="n">BondOrderParameters</span>
<span class="kn">from</span> <span class="nn">pysic.interactions.coulomb</span> <span class="kn">import</span> <span class="n">CoulombSummation</span><span class="p">,</span> <span class="n">estimate_ewald_parameters</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">math</span>

<div class="viewcode-block" id="CombPotential"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential">[docs]</a><span class="k">class</span> <span class="nc">CombPotential</span><span class="p">(</span><span class="n">CompoundPotential</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class representing a COMB potential.</span>
<span class="sd">    </span>
<span class="sd">    Use::</span>
<span class="sd">    </span>
<span class="sd">     import pysic</span>
<span class="sd">     import pysic.interactions.comb as comb_sio</span>
<span class="sd">    </span>
<span class="sd">     calc = pysic.Pysic()</span>
<span class="sd">     pot = comb_sio.CombPotential()     </span>
<span class="sd">     pot.set_calculator(calc, True)</span>
<span class="sd">     </span>
<span class="sd">    Since the potential may also define CoulombSummation (which it by default</span>
<span class="sd">    does), you should always pass the calculator to the potential in addition</span>
<span class="sd">    to passing the potential to the calculator.</span>
<span class="sd">    </span>
<span class="sd">    The potential can be modified through the exclusion list. This</span>
<span class="sd">    defines which chuncks of the potential are incorporated at any time.</span>
<span class="sd">    For instance::</span>
<span class="sd">    </span>
<span class="sd">     pot.exclude(&#39;si_self&#39;)</span>
<span class="sd">     calc.set_potentials(pot)</span>
<span class="sd">     </span>
<span class="sd">    will remove the self energy contribution from Si atoms. If you modify</span>
<span class="sd">    the potential, you need to confirm the changes by passing the potential</span>
<span class="sd">    to the calculator. This is because the potential is built in the calculator</span>
<span class="sd">    as it is passed. Therefore any changes made after that to the potential will not</span>
<span class="sd">    propagate to the calculator. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">excludes</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;direct_coulomb&#39;</span><span class="p">,</span><span class="s">&#39;long_coulomb&#39;</span><span class="p">]):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CombPotential</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">n_params</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                           <span class="n">n_targets</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_potential_type</span><span class="p">(</span><span class="s">&#39;comb&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s">&quot;Comb trial.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;siosi_bend&#39;</span><span class="p">,</span> <span class="c"># 0</span>
                                  <span class="s">&#39;osio_bend&#39;</span><span class="p">,</span> <span class="c"># 1</span>
                                  <span class="s">&#39;sisi_attractive&#39;</span><span class="p">,</span> <span class="c"># 2</span>
                                  <span class="s">&#39;oo_attractive&#39;</span><span class="p">,</span> <span class="c"># 3</span>
                                  <span class="s">&#39;sio_attractive&#39;</span><span class="p">,</span> <span class="c"># 4</span>
                                  <span class="s">&#39;sisi_bondorder&#39;</span><span class="p">,</span> <span class="c"># 5</span>
                                  <span class="s">&#39;oo_bondorder&#39;</span><span class="p">,</span> <span class="c"># 6</span>
                                  <span class="s">&#39;sio_bondorder&#39;</span><span class="p">,</span> <span class="c"># 7</span>
                                  <span class="s">&#39;sisi_repulsive&#39;</span><span class="p">,</span> <span class="c"># 8</span>
                                  <span class="s">&#39;oo_repulsive&#39;</span><span class="p">,</span> <span class="c"># 9</span>
                                  <span class="s">&#39;sio_repulsive&#39;</span><span class="p">,</span> <span class="c"># 10</span>
                                  <span class="s">&#39;si_self&#39;</span><span class="p">,</span> <span class="c"># 11</span>
                                  <span class="s">&#39;o_self&#39;</span><span class="p">,</span> <span class="c"># 12</span>
                                  <span class="s">&#39;sisi_penalty&#39;</span><span class="p">,</span> <span class="c">#13</span>
                                  <span class="s">&#39;oo_penalty&#39;</span><span class="p">,</span> <span class="c">#14</span>
                                  <span class="s">&#39;sio_penalty&#39;</span><span class="p">,</span> <span class="c">#15</span>
                                  <span class="s">&#39;sisi_coulomb&#39;</span><span class="p">,</span> <span class="c">#16</span>
                                  <span class="s">&#39;oo_coulomb&#39;</span><span class="p">,</span> <span class="c">#17</span>
                                  <span class="s">&#39;sio_coulomb&#39;</span><span class="p">,</span> <span class="c">#18</span>
                                  <span class="s">&#39;direct_coulomb&#39;</span><span class="p">,</span> <span class="c">#19</span>
                                  <span class="s">&#39;long_coulomb&#39;</span> <span class="c">#20</span>
                                  <span class="p">]</span> 

<div class="viewcode-block" id="CombPotential.set_calculator"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.set_calculator">[docs]</a>    <span class="k">def</span> <span class="nf">set_calculator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calc</span><span class="p">,</span> <span class="n">reciprocal</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
        <span class="k">if</span> <span class="n">reciprocal</span><span class="p">:</span>
            <span class="n">calc</span><span class="o">.</span><span class="n">set_potentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CombPotential.check_exclude"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.check_exclude">[docs]</a>    <span class="k">def</span> <span class="nf">check_exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot; **** unknown keyword ****&quot;</span><span class="p">,</span> <span class="n">ex</span>
</div>
<div class="viewcode-block" id="CombPotential.toggle_exclude"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.toggle_exclude">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_exclude</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
            <span class="c">#self.define_elements()</span>
    </div>
<div class="viewcode-block" id="CombPotential.exclude"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.exclude">[docs]</a>    <span class="k">def</span> <span class="nf">exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_exclude</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
            <span class="c">#self.define_elements()</span>
</div>
<div class="viewcode-block" id="CombPotential.include"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.include">[docs]</a>    <span class="k">def</span> <span class="nf">include</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_exclude</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c">#self.define_elements()</span>
</div>
<div class="viewcode-block" id="CombPotential.list_excludes"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.list_excludes">[docs]</a>    <span class="k">def</span> <span class="nf">list_excludes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span>
</div>
<div class="viewcode-block" id="CombPotential.list_possible_excludes"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.list_possible_excludes">[docs]</a>    <span class="k">def</span> <span class="nf">list_possible_excludes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span>
</div>
<div class="viewcode-block" id="CombPotential.is_included"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.is_included">[docs]</a>    <span class="k">def</span> <span class="nf">is_included</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_exclude</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
            </div>
<div class="viewcode-block" id="CombPotential.is_excluded"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.is_excluded">[docs]</a>    <span class="k">def</span> <span class="nf">is_excluded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_included</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        
</div>
<div class="viewcode-block" id="CombPotential.include_all"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.include_all">[docs]</a>    <span class="k">def</span> <span class="nf">include_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#self.define_elements()</span>
</div>
<div class="viewcode-block" id="CombPotential.exclude_all"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.exclude_all">[docs]</a>    <span class="k">def</span> <span class="nf">exclude_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">)</span>
        <span class="c">#self.define_elements()</span>
        </div>
<div class="viewcode-block" id="CombPotential.set_ewald"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.set_ewald">[docs]</a>    <span class="k">def</span> <span class="nf">set_ewald</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">calc</span><span class="p">,</span><span class="n">cheat</span><span class="p">):</span>
        <span class="n">ewald</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">CoulombSummation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cheat</span><span class="p">:</span>
            <span class="c">#print &quot;Ewald cheat&quot;</span>
            <span class="n">real_cutoff</span> <span class="o">=</span> <span class="mf">12.0</span>
            <span class="n">k_cutoff</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.535533906</span>
            <span class="n">epsilon</span> <span class="o">=</span> <span class="o">.</span><span class="mo">00552635</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#print &quot;Ewald real&quot;</span>
            <span class="n">real_cutoff</span><span class="p">,</span> <span class="n">k_cutoff</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="n">estimate_ewald_parameters</span><span class="p">(</span><span class="mf">12.0</span><span class="p">)</span>
        <span class="n">ewald</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;real_cutoff&#39;</span><span class="p">,</span><span class="n">real_cutoff</span><span class="p">)</span>
        <span class="n">ewald</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;k_cutoff&#39;</span><span class="p">,</span><span class="n">k_cutoff</span><span class="p">)</span>
        <span class="n">ewald</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;sigma&#39;</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span>
        <span class="n">ewald</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="n">epsilon</span><span class="p">)</span>
        <span class="n">calc</span><span class="o">.</span><span class="n">set_coulomb_summation</span><span class="p">(</span><span class="n">ewald</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="CombPotential.define_elements"><a class="viewcode-back" href="../../../combpotential class.html#pysic.interactions.comb.CombPotential.define_elements">[docs]</a>    <span class="k">def</span> <span class="nf">define_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#print &quot;\nBuilding Comb potential:&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c"># Si-O-Si bond bending</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-O-Si bond bending&quot;</span>
            <span class="n">bond_bend_pot</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;bond_bend&#39;</span><span class="p">)</span>
            <span class="n">bond_bend_pot</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">2.6</span><span class="p">)</span>
            <span class="n">bond_bend_pot</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;theta_0&#39;</span><span class="p">,</span><span class="mf">2.508561734</span><span class="p">)</span>
            <span class="n">bond_bend_pot</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">bond_bend_pot</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;m&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">bond_bend_pot</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">bond_bend_pot</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
            <span class="n">bond_bend_pot</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c">#is cutoff_margin correct?</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bond_bend_pot</span><span class="p">)</span>

        <span class="c"># O-Si-O bond bending</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including O-Si-O bond bending&quot;</span>
            <span class="n">bond_bend_pot2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;bond_bend&#39;</span><span class="p">)</span>
            <span class="n">bond_bend_pot2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">0.3122</span><span class="p">)</span>
            <span class="n">bond_bend_pot2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;theta_0&#39;</span><span class="p">,</span><span class="mf">1.910611932</span><span class="p">)</span>
            <span class="n">bond_bend_pot2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">bond_bend_pot2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;m&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">bond_bend_pot2</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">bond_bend_pot2</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
            <span class="n">bond_bend_pot2</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bond_bend_pot2</span><span class="p">)</span>
            
        <span class="c"># attractive Si-Si</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-Si attraction&quot;</span>
            <span class="n">B_ISiSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_exp&#39;</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">471.18</span><span class="p">)</span>  <span class="c">#B_Si </span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.658949</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin1&#39;</span><span class="p">,</span><span class="mf">1.651725</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax1&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.658949</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin2&#39;</span><span class="p">,</span><span class="mf">1.651725</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax2&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi1&#39;</span><span class="p">,</span><span class="mf">1.7322</span><span class="p">)</span>  <span class="c">#alpha_Si</span>
            <span class="n">B_ISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi2&#39;</span><span class="p">,</span><span class="mf">1.7322</span><span class="p">)</span>

            <span class="n">B_IISiSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_abs&#39;</span><span class="p">)</span>
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#aB</span>
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;b1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">9.536743164062500e-07</span><span class="p">)</span> <span class="c">#-abs(bB)**nB = -9.53674E-7</span>
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Q1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c">#QO</span>
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c">#nB</span>
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;b2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">9.536743164062500e-07</span><span class="p">)</span> 
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Q2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c">#QO</span>
            <span class="n">B_IISiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

            <span class="n">exp_potBSiSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">exp_potBSiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">exp_potBSiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mf">1.7322</span><span class="p">)</span>  <span class="c">#alpha</span>

            <span class="n">prodBSiSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">B_ISiSi</span><span class="p">,</span><span class="n">B_IISiSi</span><span class="p">,</span><span class="n">exp_potBSiSi</span><span class="p">])</span>

            <span class="n">prodBSiSi</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="c"># was 3.0</span>
            <span class="n">prodBSiSi</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span> <span class="c"># was 0.2</span>
            <span class="n">prodBSiSi</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prodBSiSi</span><span class="p">)</span>

            <span class="c"># Si-Si bond order factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
                <span class="c">#print &quot;including Si-Si bond order factor&quot;</span>

                <span class="n">bijSiSi1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">BondOrderParameters</span><span class="p">(</span><span class="s">&#39;tersoff&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="mf">1.0999E-6</span><span class="p">)</span>  <span class="c">#all Si parameters</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;eta&#39;</span><span class="p">,</span><span class="mf">0.78734</span><span class="p">)</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mf">1.7322</span><span class="p">)</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mi">100390</span><span class="p">)</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="mf">16.218</span><span class="p">)</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.59826</span><span class="p">)</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
                <span class="n">bijSiSi1</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

                <span class="n">bijSiSi2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">BondOrderParameters</span><span class="p">(</span><span class="s">&#39;tersoff&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="mf">1.0999E-6</span><span class="p">)</span>  <span class="c">#all Si parameters</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;eta&#39;</span><span class="p">,</span><span class="mf">0.78734</span><span class="p">)</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mf">1.7322</span><span class="p">)</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mi">100390</span><span class="p">)</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="mf">16.218</span><span class="p">)</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.59826</span><span class="p">)</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
                <span class="n">bijSiSi2</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

                <span class="n">coordSiSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Coordinator</span><span class="p">([</span><span class="n">bijSiSi1</span><span class="p">,</span><span class="n">bijSiSi2</span><span class="p">])</span>

                <span class="n">prodBSiSi</span><span class="o">.</span><span class="n">set_coordinator</span><span class="p">(</span><span class="n">coordSiSi</span><span class="p">)</span>


        <span class="c"># attractive O-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including O-O attraction&quot;</span>

            <span class="n">B_IOO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_exp&#39;</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">260.8931</span><span class="p">)</span>  <span class="c">#B_O</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.00112</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin1&#39;</span><span class="p">,</span><span class="mf">0.00148</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax1&#39;</span><span class="p">,</span><span class="mf">5.5046</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8349</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.00112</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin2&#39;</span><span class="p">,</span><span class="mf">0.00148</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax2&#39;</span><span class="p">,</span><span class="mf">5.5046</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8349</span><span class="p">)</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi1&#39;</span><span class="p">,</span><span class="mf">2.68</span><span class="p">)</span>  <span class="c">#alpha_O</span>
            <span class="n">B_IOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi2&#39;</span><span class="p">,</span><span class="mf">2.68</span><span class="p">)</span>

            <span class="n">B_IIOO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_abs&#39;</span><span class="p">)</span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a1&#39;</span><span class="p">,</span><span class="mf">1.00098</span><span class="p">)</span><span class="c">#1.071772002265933) #aB</span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;b1&#39;</span><span class="p">,</span><span class="o">-.</span><span class="mo">00000226</span><span class="p">)</span><span class="c">#-2.419566797838410e-06) #-abs(bB)**nB = -2.41926E-6</span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Q1&#39;</span><span class="p">,</span><span class="mf">1.83485</span><span class="p">)</span> <span class="c">#QO</span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c">#nB</span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a2&#39;</span><span class="p">,</span><span class="mf">1.00098</span><span class="p">)</span><span class="c">#1.071772002265933)</span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;b2&#39;</span><span class="p">,</span><span class="o">-.</span><span class="mo">00000226</span><span class="p">)</span><span class="c">#-2.419566797838410e-06) </span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Q2&#39;</span><span class="p">,</span><span class="mf">1.83485</span><span class="p">)</span> <span class="c">#QO</span>
            <span class="n">B_IIOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
            
            <span class="n">exp_potBOO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">exp_potBOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">exp_potBOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mf">2.68</span><span class="p">)</span> <span class="c">#alpha</span>

            <span class="n">prodBOO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">B_IOO</span><span class="p">,</span><span class="n">B_IIOO</span><span class="p">,</span><span class="n">exp_potBOO</span><span class="p">])</span>
            
            <span class="n">prodBOO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
            <span class="n">prodBOO</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
            <span class="n">prodBOO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prodBOO</span><span class="p">)</span>
            
            <span class="c"># O-O bond order factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
                <span class="c">#print &quot;including O-O bond order factor&quot;</span>

                <span class="n">bijOO1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">BondOrderParameters</span><span class="p">(</span><span class="s">&#39;tersoff&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span> <span class="c">#all O parameters</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;eta&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mf">2.68</span><span class="p">)</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mf">6.6</span><span class="p">)</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.229</span><span class="p">)</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
                <span class="n">bijOO1</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

                <span class="n">bijOO2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">BondOrderParameters</span><span class="p">(</span><span class="s">&#39;tersoff&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span> <span class="c">#all O parameters</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;eta&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mf">2.68</span><span class="p">)</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mf">6.6</span><span class="p">)</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.229</span><span class="p">)</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
                <span class="n">bijOO2</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>

                <span class="n">coordOO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Coordinator</span><span class="p">([</span><span class="n">bijOO1</span><span class="p">,</span><span class="n">bijOO2</span><span class="p">])</span>

                <span class="n">prodBOO</span><span class="o">.</span><span class="n">set_coordinator</span><span class="p">(</span><span class="n">coordOO</span><span class="p">)</span>



        <span class="c"># attractive Si-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-O attraction&quot;</span>

            <span class="n">B_ISiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_exp&#39;</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">350.6103405</span><span class="p">)</span>  <span class="c"># sqrt(B_Si*B_O)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.658949</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin1&#39;</span><span class="p">,</span><span class="mf">1.651725</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax1&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.00112</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin2&#39;</span><span class="p">,</span><span class="mf">0.00148</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax2&#39;</span><span class="p">,</span><span class="mf">5.5046</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8349</span><span class="p">)</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi1&#39;</span><span class="p">,</span><span class="mf">1.7322</span><span class="p">)</span>  <span class="c">#alpha_Si</span>
            <span class="n">B_ISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi2&#39;</span><span class="p">,</span><span class="mf">2.68</span><span class="p">)</span>  <span class="c">#alpha O</span>

            <span class="n">B_IISiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_abs&#39;</span><span class="p">)</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#aB_Si</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;b1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.536743164062500e-07</span><span class="p">)</span> <span class="c">#-abs(bB)**nB for Si</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Q1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c">#QO of Si</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c">#nB</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a2&#39;</span><span class="p">,</span><span class="mf">1.00098</span><span class="p">)</span><span class="c">#1.071772002265933) #aB_O</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;b2&#39;</span><span class="p">,</span><span class="o">-.</span><span class="mo">00000226</span><span class="p">)</span><span class="c">#-2.419566797838410e-06) #-abs(bB)**nB for O</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Q2&#39;</span><span class="p">,</span><span class="mf">1.83485</span><span class="p">)</span> <span class="c">#QO of O</span>
            <span class="n">B_IISiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
            
            <span class="n">exp_potBSiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">exp_potBSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
            <span class="n">exp_potBSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mf">2.2061</span><span class="p">)</span>  <span class="c">#alpha_SiO = (alpha_Si+alpha_O)/2</span>

            <span class="n">prodBSiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">B_ISiO</span><span class="p">,</span><span class="n">B_IISiO</span><span class="p">,</span><span class="n">exp_potBSiO</span><span class="p">])</span>
            
            <span class="n">prodBSiO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>        <span class="c"># sqrt</span>
            <span class="n">prodBSiO</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="c">#0.3018)  # Rs_both is sqrt(Rs1*Rs2) </span>
            <span class="n">prodBSiO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prodBSiO</span><span class="p">)</span>
            
            <span class="c"># Si-O bond order factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
                <span class="c">#print &quot;including Si-O bond order factor&quot;</span>

                <span class="n">bijOSi1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">BondOrderParameters</span><span class="p">(</span><span class="s">&#39;tersoff&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="c">#O</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;eta&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mf">2.2061</span><span class="p">)</span> <span class="c">#media between Si and O parameters</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mf">6.6</span><span class="p">)</span> <span class="c"># O</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.229</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
                <span class="n">bijOSi1</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c">#for O</span>

                <span class="n">bijOSi2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">BondOrderParameters</span><span class="p">(</span><span class="s">&#39;tersoff&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="c">#O</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;eta&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mf">2.2061</span><span class="p">)</span> <span class="c">#media between Si and O parameters</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mf">6.6</span><span class="p">)</span> <span class="c"># O</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.229</span><span class="p">)</span> <span class="c">#O</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
                <span class="n">bijOSi2</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c">#for O</span>

                <span class="n">bijSiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">BondOrderParameters</span><span class="p">(</span><span class="s">&#39;tersoff&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[[</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">],[</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">]])</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="mf">1.0999E-6</span><span class="p">)</span>  <span class="c">#Si</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;eta&#39;</span><span class="p">,</span><span class="mf">0.78734</span><span class="p">)</span> <span class="c">#Si</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c">#Si</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mf">2.2061</span><span class="p">)</span>   <span class="c">#media between Si and O parameters</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mi">100390</span><span class="p">)</span> <span class="c">#Si</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="mf">16.218</span><span class="p">)</span> <span class="c">#Si</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.59826</span><span class="p">)</span> <span class="c">#Si</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
                <span class="n">bijSiO</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c">#for Si</span>

                <span class="n">coordSiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Coordinator</span><span class="p">([</span><span class="n">bijOSi1</span><span class="p">,</span><span class="n">bijOSi2</span><span class="p">,</span> <span class="n">bijSiO</span><span class="p">])</span>

                <span class="n">prodBSiO</span><span class="o">.</span><span class="n">set_coordinator</span><span class="p">(</span><span class="n">coordSiO</span><span class="p">)</span>

            
        <span class="c"># repulsive Si-Si</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-Si repulsion&quot;</span>

            <span class="n">ASiSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_exp&#39;</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1830.8</span><span class="p">)</span>  <span class="c">#A_Si</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.658949</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin1&#39;</span><span class="p">,</span><span class="mf">1.651725</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax1&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.658949</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin2&#39;</span><span class="p">,</span><span class="mf">1.651725</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax2&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi1&#39;</span><span class="p">,</span><span class="mf">2.4799</span><span class="p">)</span> <span class="c">#lambda</span>
            <span class="n">ASiSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi2&#39;</span><span class="p">,</span><span class="mf">2.4799</span><span class="p">)</span>

            <span class="n">exp_potSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">exp_potSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">exp_potSi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span> <span class="mf">2.4799</span><span class="p">)</span>  <span class="c">#lambda_Si</span>
            
            <span class="n">prodASiSi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">ASiSi</span><span class="p">,</span><span class="n">exp_potSi</span><span class="p">])</span>

            <span class="n">prodASiSi</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="c"># was 3.0</span>
            <span class="n">prodASiSi</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span> <span class="c"># was 0.2</span>
            <span class="n">prodASiSi</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prodASiSi</span><span class="p">)</span>

        <span class="c"># repulsive O-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including O-O repulsion&quot;</span>

            <span class="n">AOO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_exp&#39;</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">3326.699</span><span class="p">)</span>  <span class="c">#A_O</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.00112</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin1&#39;</span><span class="p">,</span><span class="mf">0.00148</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax1&#39;</span><span class="p">,</span><span class="mf">5.5046</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8349</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.00112</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin2&#39;</span><span class="p">,</span><span class="mf">0.00148</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax2&#39;</span><span class="p">,</span><span class="mf">5.5046</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8349</span><span class="p">)</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi1&#39;</span><span class="p">,</span><span class="mf">5.36</span><span class="p">)</span> <span class="c">#lambda</span>
            <span class="n">AOO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi2&#39;</span><span class="p">,</span><span class="mf">5.36</span><span class="p">)</span>

            <span class="n">exp_potO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">exp_potO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">exp_potO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mf">5.36</span><span class="p">)</span>  <span class="c">#lambda_O</span>

            <span class="n">prodAOO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">AOO</span><span class="p">,</span><span class="n">exp_potO</span><span class="p">])</span>
 
            <span class="n">prodAOO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
            <span class="n">prodAOO</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
            <span class="n">prodAOO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prodAOO</span><span class="p">)</span>

            
        <span class="c"># repulsive Si-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-O repulsion&quot;</span>

            <span class="n">ASiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_exp&#39;</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">2467.894659826</span><span class="p">)</span> <span class="c">#sqrt(A_Si*A_O)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.658949</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin1&#39;</span><span class="p">,</span><span class="mf">1.651725</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax1&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin1&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmax2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.00112</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Rmin2&#39;</span><span class="p">,</span><span class="mf">0.00148</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmax2&#39;</span><span class="p">,</span><span class="mf">5.5046</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;Qmin2&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8349</span><span class="p">)</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi1&#39;</span><span class="p">,</span><span class="mf">2.4799</span><span class="p">)</span> <span class="c">#lambda</span>
            <span class="n">ASiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;xi2&#39;</span><span class="p">,</span><span class="mf">5.36</span><span class="p">)</span>
            
            <span class="n">exp_potSiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">exp_potSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">exp_potSiO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span> <span class="mf">3.91995</span><span class="p">)</span>  <span class="c"># (lambda_Si + lambda_O)/2</span>

            <span class="n">prodASiO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">ASiO</span><span class="p">,</span><span class="n">exp_potSiO</span><span class="p">])</span>

            <span class="n">prodASiO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">3.05</span><span class="p">)</span>
            <span class="n">prodASiO</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="c">#0.3018)  # Rs_both is sqrt(Rs1*Rs2) </span>
            <span class="n">prodASiO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prodASiO</span><span class="p">)</span>


        <span class="c"># charge self-energy Si</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si self energy&quot;</span>

            <span class="n">chiSiJ</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">chiSiJ</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">3.625144859</span><span class="p">)</span>      <span class="c">#J, X = 0 and K = 0 for Si</span>
            <span class="n">chiSiJ</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">chiSiL</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">chiSiL</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">0.087067714</span><span class="p">)</span>       <span class="c"># L</span>
            <span class="n">chiSiL</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">chiSiJ</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chiSiL</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            
            <span class="c">#selfpot offset</span>
            <span class="n">selfpotsi</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">selfpotsi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.000413097</span><span class="p">)</span>
            <span class="n">selfpotsi</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">selfpotsi</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">chiSiJ</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">chiSiL</span><span class="p">])</span>
            <span class="c">#self.pieces.append([selfpotsi])</span>

            
        <span class="c"># charge self-energy O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including O self energy&quot;</span>

            <span class="n">chiOX</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">chiOX</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">5.63441383</span><span class="p">)</span>     <span class="c">#X</span>
            <span class="n">chiOX</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chiOJ</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">chiOJ</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">7.689598017</span><span class="p">)</span>   <span class="c">#J</span>
            <span class="n">chiOJ</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">chiOK</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">chiOK</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">4.51426991</span><span class="p">)</span>    <span class="c">#K</span>
            <span class="n">chiOK</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">chiOL</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">chiOL</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">1.330079082</span><span class="p">)</span>      <span class="c">#L</span>
            <span class="n">chiOL</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">chiOX</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chiOJ</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chiOK</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chiOL</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">])</span>

            <span class="c">#selfpot contribution</span>
            <span class="n">selfpoto</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_self&#39;</span><span class="p">)</span>
            <span class="n">selfpoto</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.000413097</span><span class="p">)</span>
            <span class="n">selfpoto</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">selfpoto</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chiOX</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chiOJ</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chiOK</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chiOL</span><span class="p">)</span>
            <span class="c">#self.pieces.append(selfpoto)</span>

        <span class="n">pow1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;power&#39;</span><span class="p">)</span>           <span class="c">#just multiplies by r</span>
        <span class="n">pow1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pow1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pow1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pow2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;power&#39;</span><span class="p">)</span>           <span class="c">#just multiplies by (1/r^5)</span>
        <span class="n">pow2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pow2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pow2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> 


        <span class="n">chp1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">8.362034089934842e-07</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho1_Si)</span>
        <span class="n">chp1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>

        <span class="n">chp4</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.499378</span><span class="p">)</span>  <span class="c">#is (rho1_Si)</span>
        <span class="n">chp4</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp4</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>

        <span class="n">chp1b</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">5.023320620606138e-06</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho2_Si)</span>
        <span class="n">chp1b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp1b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>

        <span class="n">chp4b</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">2.999911</span><span class="p">)</span>  <span class="c">#is (rho2_Si)</span>
        <span class="n">chp4b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp4b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>

        <span class="n">chp1c</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">8.362034089934842e-07</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho1_Si)</span>
        <span class="n">chp1c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">chp1c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>

        <span class="n">chp4c</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.499378</span><span class="p">)</span>  <span class="c">#is (rho1_Si)</span>
        <span class="n">chp4c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">chp4c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i </span>

        <span class="n">chp1d</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">5.023320620606138e-06</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho2_Si)</span>
        <span class="n">chp1d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">chp1d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>

        <span class="n">chp4d</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">2.999911</span><span class="p">)</span>  <span class="c">#is (rho2_Si)</span>
        <span class="n">chp4d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">chp4d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>

        
        <span class="c"># penalty function Si-Si</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-Si penalty&quot;</span>

            <span class="n">prod1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod1</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>   
            <span class="c">#prod1.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1</span><span class="p">)</span>

            <span class="n">chp2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.003444090792181e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho1_Si)</span>
            <span class="n">chp2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>
            <span class="n">chp2</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp2</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2</span><span class="p">)</span>

            <span class="n">chp3</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">2.006888181584362e-06</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho1_Si)</span>
            <span class="n">chp3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>
            <span class="n">chp3</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp3</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3</span><span class="p">)</span>

            <span class="n">chp4</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp4</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp4.set_cutoff_margin(0.2)</span>
            <span class="n">prod2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod2</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2</span><span class="p">)</span>

            <span class="c">#Second term------------------------------------------------------------------------------------------</span>
            <span class="n">prod1b</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1b</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1b</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod1b</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1b.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1b</span><span class="p">)</span>

            <span class="n">chp2b</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">6.027984744727366e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho2_Si)</span>
            <span class="n">chp2b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp2b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>
            <span class="n">chp2b</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp2b</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2b.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2b</span><span class="p">)</span>

            <span class="n">chp3b</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.205596948945473e-05</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho2_Si)</span>
            <span class="n">chp3b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp3b</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>
            <span class="n">chp3b</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp3b</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3b.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3b</span><span class="p">)</span>

            <span class="n">chp4b</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp4b</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">chp4b</span><span class="o">.</span><span class="n">set_cutoff_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">prod2b</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4b</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2b</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod2b</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2b.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2b</span><span class="p">)</span>

            <span class="c">#Third term---------------------------------------------------------------------------------------</span>
            <span class="n">prod1c</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1c</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1c</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod1c</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1c.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1c</span><span class="p">)</span>

            <span class="n">chp2c</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.003444090792181e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho1_Si)</span>
            <span class="n">chp2c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chp2c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>
            <span class="n">chp2c</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp2c</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2c.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2c</span><span class="p">)</span>

            <span class="n">chp3c</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">2.006888181584362e-06</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho1_Si)</span>
            <span class="n">chp3c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chp3c</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>
            <span class="n">chp3c</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp3c</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3c.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3c</span><span class="p">)</span>

            <span class="n">chp4c</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp4c</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp4c.set_cutoff_margin(0.2)</span>
            <span class="n">prod2c</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4c</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2c</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod2c</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2c.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2c</span><span class="p">)</span>

            <span class="c">#Forth term-------------------------------------------------------------------------------------</span>
            <span class="n">prod1d</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1d</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1d</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod1d</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1d.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1d</span><span class="p">)</span>

            <span class="n">chp2d</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">6.027984744727366e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho2_Si)</span>
            <span class="n">chp2d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">chp2d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>
            <span class="n">chp2d</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp2d</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2d.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2d</span><span class="p">)</span>

            <span class="n">chp3d</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.205596948945473e-05</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho2_Si)</span>
            <span class="n">chp3d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">chp3d</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>
            <span class="n">chp3d</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp3d</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3d.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3d</span><span class="p">)</span>

            <span class="n">chp4d</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">chp4d</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp4d.set_cutoff_margin(0.2)</span>
            <span class="n">prod2d</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4d</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2d</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
            <span class="n">prod2d</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2d.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2d</span><span class="p">)</span>



        <span class="n">chp1O</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">6.567367742091049e-06</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho1_O)</span>
        <span class="n">chp1O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp1O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>

        <span class="n">chp4O</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.9220110000000</span><span class="p">)</span>  <span class="c">#is (rho1_O)</span>
        <span class="n">chp4O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp4O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>
 
        <span class="n">chp1bO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">1.626073682913237e-06</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho2_O)</span>
        <span class="n">chp1bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp1bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>

        <span class="n">chp4bO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">0.971086</span><span class="p">)</span>  <span class="c">#is (rho2_O)</span>
        <span class="n">chp4bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">chp4bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>

        <span class="n">chp1cO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">6.567367742091049e-06</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho1_O)</span>
        <span class="n">chp1cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">chp1cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>

        <span class="n">chp4cO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.922011000</span><span class="p">)</span>  <span class="c"># is (rho1_O)</span>
        <span class="n">chp4cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">chp4cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>                   <span class="c"># multiplies by q_i </span>

        <span class="n">chp1dO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp1dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">1.626073682913237e-06</span><span class="p">)</span>  <span class="c">#is (5/rc^6 * rho2_O)</span>
        <span class="n">chp1dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">chp1dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>

        <span class="n">chp4dO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">chp4dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">0.971086</span><span class="p">)</span>  <span class="c">#is (rho2_O)</span>
        <span class="n">chp4dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">chp4dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>


        <span class="c"># penalty function O-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span> 
            <span class="c">#print &quot;including O-O penalty&quot;</span>

            <span class="c">#First term--------------------------------------------------------------------------------------</span>
            <span class="n">prod1O</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1O</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1O</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1O</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1O.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1O</span><span class="p">)</span>

            <span class="n">chp2O</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">7.880841290509259e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho1_O)</span>
            <span class="n">chp2O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp2O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>
            <span class="n">chp2O</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2O</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2O.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2O</span><span class="p">)</span>

            <span class="n">chp3O</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.576168258101852e-05</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho1_O)</span>
            <span class="n">chp3O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp3O</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>
            <span class="n">chp3O</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3O</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3O.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3O</span><span class="p">)</span>

            <span class="n">prod2O</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4O</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2O</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2O</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2O.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2O</span><span class="p">)</span>


            <span class="c">#Second term-----------------------------------------------------------------------------------------</span>
            <span class="n">prod1bO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1bO</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1bO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1bO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1bO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1bO</span><span class="p">)</span>
 
            <span class="n">chp2bO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.951288419495885e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho2_O)</span>
            <span class="n">chp2bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp2bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>
            <span class="n">chp2bO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2bO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2bO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2bO</span><span class="p">)</span>

            <span class="n">chp3bO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">3.902576838991770e-06</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho2_O)</span>
            <span class="n">chp3bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp3bO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>
            <span class="n">chp3bO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3bO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3bO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3bO</span><span class="p">)</span>

            <span class="n">prod2bO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4bO</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2bO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2bO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2bO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2bO</span><span class="p">)</span>

            <span class="c">#Third term---------------------------------------------------------------------------------------</span>
            <span class="n">prod1cO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1cO</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1cO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1cO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1cO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1cO</span><span class="p">)</span>

            <span class="n">chp2cO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">7.880841290509259e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho1_O)</span>
            <span class="n">chp2cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chp2cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>
            <span class="n">chp2cO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2cO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2cO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2cO</span><span class="p">)</span>

            <span class="n">chp3cO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">1.576168258101852e-05</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho1_O)</span>
            <span class="n">chp3cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chp3cO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>
            <span class="n">chp3cO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3cO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3cO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3cO</span><span class="p">)</span>

            <span class="n">prod2cO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4cO</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2cO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2cO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2cO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2cO</span><span class="p">)</span>

            <span class="c">#Forth term------------------------------------------------------------------------------------------</span>
            <span class="n">prod1dO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1dO</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1dO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1dO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1dO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1dO</span><span class="p">)</span>

            <span class="n">chp2dO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.951288419495885e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho2_O)</span>
            <span class="n">chp2dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">chp2dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>
            <span class="n">chp2dO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2dO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2dO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2dO</span><span class="p">)</span>

            <span class="n">chp3dO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">3.902576838991770e-06</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho2_O)</span>
            <span class="n">chp3dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">chp3dO</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>
            <span class="n">chp3dO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3dO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3dO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3dO</span><span class="p">)</span>

            <span class="n">prod2dO</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4dO</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2dO</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2dO</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2dO.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2dO</span><span class="p">)</span>


        <span class="c"># penalty function Si-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-O penalty&quot;</span>

            <span class="c">#First term--------------------------------------------------------------------------------------</span>
            <span class="n">prod1mix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1mix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1mix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1mix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1mix</span><span class="p">)</span>

            <span class="n">chp2mix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2mix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.003444090792181e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho1_Si)</span>
            <span class="n">chp2mix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp2mix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>
            <span class="n">chp2mix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2mix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2mix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2mix</span><span class="p">)</span>

            <span class="n">chp3mix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3mix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">2.006888181584362e-06</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho1_Si)</span>
            <span class="n">chp3mix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp3mix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>          <span class="c"># multiplies by q_j </span>
            <span class="n">chp3mix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3mix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3mix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3mix</span><span class="p">)</span>

            <span class="n">prod2mix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2mix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2mix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2mix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2mix</span><span class="p">)</span>

            <span class="c">#Second term--------------------------------------------------------------------------------------</span>
            <span class="n">prod1bmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1b</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1bmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1bmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1bmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1bmix</span><span class="p">)</span>

            <span class="n">chp2bmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2bmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">6.027984744727366e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho2_Si)</span>
            <span class="n">chp2bmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp2bmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>
            <span class="n">chp2bmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2bmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2bmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2bmix</span><span class="p">)</span>

            <span class="n">chp3bmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3bmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.205596948945473e-05</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho2_Si)</span>
            <span class="n">chp3bmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">chp3bmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c"># multiplies by q_j^2 </span>
            <span class="n">chp3bmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3bmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3bmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3bmix</span><span class="p">)</span>

            <span class="n">prod2bmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4b</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2bmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2bmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2bmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2bmix</span><span class="p">)</span>

            <span class="c">#Third term---------------------------------------------------------------------------------------------</span>
            <span class="n">prod1cmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1cO</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1cmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1cmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1cmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1cmix</span><span class="p">)</span>

            <span class="n">chp2cmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2cmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">7.880841290509259e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho1_O)</span>
            <span class="n">chp2cmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chp2cmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>
            <span class="n">chp2cmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2cmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2cmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2cmix</span><span class="p">)</span>

            <span class="n">chp3cmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3cmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">1.576168258101852e-05</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho1_O)</span>
            <span class="n">chp3cmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chp3cmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i</span>
            <span class="n">chp3cmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3cmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3cmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3cmix</span><span class="p">)</span>

            <span class="n">prod2cmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4cO</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2cmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2cmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2cmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2cmix</span><span class="p">)</span>

            <span class="c">#Forth term------------------------------------------------------------------------------------------</span>
            <span class="n">prod1dmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp1dO</span><span class="p">,</span> <span class="n">pow1</span><span class="p">])</span>
            <span class="n">prod1dmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod1dmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod1dmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod1dmix</span><span class="p">)</span>

            <span class="n">chp2dmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp2dmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.951288419495885e-05</span><span class="p">)</span>  <span class="c">#is -(5/rc^5 * rho2_O)</span>
            <span class="n">chp2dmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">chp2dmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>
            <span class="n">chp2dmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp2dmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp2dmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp2dmix</span><span class="p">)</span>

            <span class="n">chp3dmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">chp3dmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">3.902576838991770e-06</span><span class="p">)</span>  <span class="c">#is -(1/rc^5 * rho2_O)</span>
            <span class="n">chp3dmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">chp3dmix</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>          <span class="c"># multiplies by q_i^2 </span>
            <span class="n">chp3dmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">chp3dmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#chp3dmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chp3dmix</span><span class="p">)</span>

            <span class="n">prod2dmix</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">chp4dO</span><span class="p">,</span> <span class="n">pow2</span><span class="p">])</span>
            <span class="n">prod2dmix</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
            <span class="n">prod2dmix</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="c">#prod2dmix.set_cutoff_margin(0.2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prod2dmix</span><span class="p">)</span>

        <span class="n">charged</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
        <span class="n">charged</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">charged</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">charged</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">decay</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;power&#39;</span><span class="p">)</span>
        <span class="n">decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span> <span class="mf">14.3996</span><span class="p">)</span>
        <span class="n">decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">si_zeta</span> <span class="o">=</span> <span class="mf">0.772871</span>
        <span class="n">o_zeta</span>  <span class="o">=</span> <span class="mf">2.243072</span>

        <span class="n">si_exp_decay</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
        <span class="n">si_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">si_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">si_zeta</span><span class="p">)</span>

        <span class="n">o_exp_decay</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
        <span class="n">o_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">o_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span>


        <span class="c"># coulomb Si-Si</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-Si coulomb&quot;</span>
            
            <span class="n">poly_sisi1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_sisi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">11.0</span><span class="o">/</span><span class="mf">8.0</span><span class="o">*</span><span class="n">si_zeta</span><span class="p">)</span>
            <span class="n">poly_sisi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_sisi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_sisi1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">poly_sisi2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_sisi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">4.0</span><span class="o">*</span><span class="n">si_zeta</span><span class="o">*</span><span class="n">si_zeta</span><span class="p">)</span>
            <span class="n">poly_sisi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_sisi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_sisi2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">poly_sisi3</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_sisi3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">6.0</span><span class="o">*</span><span class="n">si_zeta</span><span class="o">*</span><span class="n">si_zeta</span><span class="o">*</span><span class="n">si_zeta</span><span class="p">)</span>
            <span class="n">poly_sisi3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_sisi3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_sisi3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            
            
            <span class="c"># offsets</span>
            <span class="n">sisi_offset1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">sisi_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.000919025</span><span class="p">)</span>
            <span class="n">sisi_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sisi_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">sisi_offset2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">sisi_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="n">sisi_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sisi_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sisi_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                        
            <span class="n">sisi_offsetB</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">sisi_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">0.0118523</span><span class="p">)</span>
            <span class="n">sisi_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sisi_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                        
            

            <span class="n">coul_sisi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
                <span class="c">#print &quot;including Si-Si direct coulomb&quot;</span>
                <span class="n">coul_sisi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sisi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">si_exp_decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sisi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">si_exp_decay</span><span class="p">,</span><span class="n">poly_sisi1</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sisi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">si_exp_decay</span><span class="p">,</span><span class="n">poly_sisi2</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sisi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">si_exp_decay</span><span class="p">,</span><span class="n">poly_sisi3</span><span class="p">])</span> <span class="p">)</span>

            <span class="c">#coul_sisi.append( pysic.ProductPotential([sisi_offset1,sisi_offset2]) )</span>
            <span class="c">#coul_sisi.append( sisi_offsetB )</span>

            <span class="k">for</span> <span class="n">c_sisi</span> <span class="ow">in</span> <span class="n">coul_sisi</span><span class="p">:</span>
                <span class="n">c_sisi</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;Si&#39;</span><span class="p">])</span>
                <span class="n">c_sisi</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">12.0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_sisi</span><span class="p">)</span>

            
        <span class="c"># coulomb O-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including O-O coulomb&quot;</span>

            <span class="n">poly_oo1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_oo1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">11.0</span><span class="o">/</span><span class="mf">8.0</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span>
            <span class="n">poly_oo1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_oo1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_oo1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">poly_oo2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_oo2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">4.0</span><span class="o">*</span><span class="n">o_zeta</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span>
            <span class="n">poly_oo2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_oo2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_oo2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">poly_oo3</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_oo3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">6.0</span><span class="o">*</span><span class="n">o_zeta</span><span class="o">*</span><span class="n">o_zeta</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span>
            <span class="n">poly_oo3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_oo3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_oo3</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>


            <span class="c"># offsets</span>
            <span class="n">oo_offset1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">oo_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.000922181</span><span class="p">)</span>
            <span class="n">oo_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">oo_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">oo_offset2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">oo_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="n">oo_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">oo_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">oo_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                        
            <span class="n">oo_offsetB</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">oo_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">0.0118924</span><span class="p">)</span>
            <span class="n">oo_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">oo_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>


            <span class="n">coul_oo</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
                <span class="c">#print &quot;including O-O direct coulomb&quot;</span>
                <span class="n">coul_oo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_oo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">o_exp_decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_oo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">o_exp_decay</span><span class="p">,</span><span class="n">poly_oo1</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_oo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">o_exp_decay</span><span class="p">,</span><span class="n">poly_oo2</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_oo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">o_exp_decay</span><span class="p">,</span><span class="n">poly_oo3</span><span class="p">])</span> <span class="p">)</span>

            <span class="c">#coul_oo.append( pysic.ProductPotential([oo_offset1,oo_offset2]) )</span>
            <span class="c">#coul_oo.append( oo_offsetB )</span>
            
            <span class="k">for</span> <span class="n">c_oo</span> <span class="ow">in</span> <span class="n">coul_oo</span><span class="p">:</span>
                <span class="n">c_oo</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
                <span class="n">c_oo</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">12.0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_oo</span><span class="p">)</span>

        <span class="c"># coulomb Si-O</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="c">#print &quot;including Si-O coulomb&quot;</span>

            <span class="n">kappa</span> <span class="o">=</span> <span class="p">(</span><span class="n">si_zeta</span><span class="o">*</span><span class="n">si_zeta</span> <span class="o">+</span> <span class="n">o_zeta</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">si_zeta</span><span class="o">*</span><span class="n">si_zeta</span> <span class="o">-</span> <span class="n">o_zeta</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span>
            
            <span class="n">poly_sio1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_sio1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,(</span><span class="mi">1</span><span class="o">-</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">4.0</span><span class="o">*</span><span class="n">si_zeta</span><span class="p">)</span>
            <span class="n">poly_sio1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_sio1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_sio1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">poly_sio2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">poly_sio2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,(</span><span class="mi">1</span><span class="o">+</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">4.0</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span>
            <span class="n">poly_sio2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">poly_sio2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">poly_sio2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">scaled_si_exp_decay</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">scaled_si_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">kappa</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span>
            <span class="n">scaled_si_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">si_zeta</span><span class="p">)</span>
        
            <span class="n">scaled_o_exp_decay</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>
            <span class="n">scaled_o_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">kappa</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">kappa</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span>
            <span class="n">scaled_o_exp_decay</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;zeta&#39;</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">o_zeta</span><span class="p">)</span>



            <span class="c"># offsets</span>
            <span class="n">sio_offset1</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">sio_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">0.000921978</span><span class="p">)</span>
            <span class="n">sio_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sio_offset1</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">sio_offset2</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;shift_power&#39;</span><span class="p">)</span>
            <span class="n">sio_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="n">sio_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sio_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;r2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sio_offset2</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                        
            <span class="n">sio_offsetB</span> <span class="o">=</span> <span class="n">pysic</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="s">&#39;charge_pair&#39;</span><span class="p">)</span>
            <span class="n">sio_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">,</span><span class="mf">0.0118897</span><span class="p">)</span>
            <span class="n">sio_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sio_offsetB</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="s">&#39;n2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>


            <span class="n">coul_sio</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
                <span class="c">#print &quot;including Si-O direct coulomb&quot;</span>
                <span class="n">coul_sio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">scaled_si_exp_decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">scaled_o_exp_decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">poly_sio1</span><span class="p">,</span><span class="n">si_exp_decay</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">coul_sio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pysic</span><span class="o">.</span><span class="n">ProductPotential</span><span class="p">([</span><span class="n">charged</span><span class="p">,</span><span class="n">decay</span><span class="p">,</span><span class="n">poly_sio2</span><span class="p">,</span><span class="n">o_exp_decay</span><span class="p">])</span> <span class="p">)</span>

            <span class="c">#coul_sio.append( pysic.ProductPotential([sio_offset1,sio_offset2]) )</span>
            <span class="c">#coul_sio.append( sio_offsetB )</span>

            <span class="k">for</span> <span class="n">c_sio</span> <span class="ow">in</span> <span class="n">coul_sio</span><span class="p">:</span>
                <span class="n">c_sio</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">([</span><span class="s">&#39;Si&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">])</span>
                <span class="n">c_sio</span><span class="o">.</span><span class="n">set_cutoff</span><span class="p">(</span><span class="mf">12.0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_sio</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;A Pysic calculator needed for Ewald. Use set_calculator(calc).&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_excludes</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludes</span><span class="p">:</span>
                <span class="c">#print &quot;including Ewald without k-summation&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_ewald</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">,</span><span class="n">cheat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c">#print &quot;including Ewald with k-summation&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_ewald</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">,</span><span class="n">cheat</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                
        <span class="c">#print &quot;\n&quot;</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">Pysic 0.6 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../pysic.html" >pysic</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2013, Teemu Hynninen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>